

============================== 2023-01-04 00:33:10.511003 | a1c8ffeb-6613-42bb-b7d0-347aa9b0d3e5 ==============================
[0m00:33:10.511030 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:10.511837 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_payments"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:33:10.512614 [debug] [MainThread]: Tracking: tracking
[0m00:33:10.518124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28a6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28a6730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28a6790>]}
[0m00:33:10.529448 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:33:10.531809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a1c8ffeb-6613-42bb-b7d0-347aa9b0d3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2898f10>]}
[0m00:33:10.594632 [debug] [MainThread]: Parsing macros/drop_table.sql
[0m00:33:10.596231 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
[0m00:33:10.603422 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:33:10.606166 [debug] [MainThread]: Parsing macros/relations.sql
[0m00:33:10.608819 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m00:33:10.610912 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:33:10.640369 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m00:33:10.642768 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m00:33:10.644208 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:33:10.648542 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:33:10.651986 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:33:10.654057 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:33:10.655543 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:33:10.663015 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:33:10.664641 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:33:10.667374 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:33:10.673817 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:33:10.679274 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql


============================== 2023-01-04 00:33:10.688070 | 6fcbd11c-96ad-4eea-8914-62e7d24766e5 ==============================
[0m00:33:10.688131 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:10.690501 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_customers"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:33:10.691744 [debug] [MainThread]: Tracking: tracking
[0m00:33:10.702833 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:33:10.705748 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:33:10.710956 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:33:10.714718 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:33:10.717165 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:33:10.729412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d93820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d93730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d93790>]}
[0m00:33:10.731895 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:33:10.744121 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:33:10.745656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fcbd11c-96ad-4eea-8914-62e7d24766e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d82430>]}
[0m00:33:10.761105 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:33:10.780891 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:33:10.786259 [debug] [MainThread]: Parsing macros/drop_table.sql
[0m00:33:10.789102 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
[0m00:33:10.791002 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:33:10.788461 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:33:10.793478 [debug] [MainThread]: Parsing macros/relations.sql
[0m00:33:10.794314 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:33:10.796675 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m00:33:10.800423 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:33:10.806445 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:33:10.810967 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:33:10.815738 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:33:10.822878 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:33:10.822948 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m00:33:10.827092 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m00:33:10.833721 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:33:10.834487 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:33:10.847684 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:33:10.853073 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:33:10.857695 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:33:10.858900 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:33:10.858106 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:33:10.866721 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:33:10.871111 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:33:10.875422 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:33:10.876969 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:33:10.879609 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:33:10.878963 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:33:10.887717 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:33:10.896495 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:33:10.898333 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:33:10.903475 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:33:10.904828 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:33:10.913912 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:33:10.912244 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:33:10.916664 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:33:10.919176 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:33:10.918626 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:33:10.921020 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:33:10.922732 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:33:10.924539 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:33:10.927160 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:33:10.928740 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:33:10.929615 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:33:10.931674 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:33:10.932608 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:33:10.934624 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:33:10.935892 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:33:10.934392 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:33:10.937460 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:33:10.938641 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:33:10.939907 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:33:10.943305 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:33:10.944806 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:33:10.946201 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:33:10.947572 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:33:10.951997 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:33:10.958316 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:33:10.960069 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:33:10.962736 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:33:10.964077 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:33:10.966617 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:33:10.968791 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:33:10.972241 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:33:10.976383 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:33:10.978651 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:33:10.980796 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:33:10.984553 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:33:10.984528 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:33:10.988234 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:33:10.992601 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:33:10.996024 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:33:11.010465 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:33:11.008611 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:33:11.015675 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:33:11.022805 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:33:11.026638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:33:11.033641 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:33:11.039375 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:33:11.039497 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:33:11.044857 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:33:11.048778 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:33:11.052385 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:33:11.064632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:33:11.083943 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:33:11.086332 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:33:11.087542 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:33:11.088641 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:33:11.090246 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:33:11.091604 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:33:11.092874 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:33:11.093969 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:33:11.095441 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:33:11.097482 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:33:11.099748 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:33:11.101216 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:33:11.103359 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:33:11.105008 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:33:11.106769 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:33:11.108381 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:33:11.109535 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:33:11.111439 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:33:11.113418 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:33:11.115242 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:33:11.117652 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:33:11.119668 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:33:11.122638 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:33:11.125807 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:33:11.127578 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:33:11.129027 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:33:11.130643 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:33:11.132399 [debug] [MainThread]: Parsing macros/adapters/schema.sql


============================== 2023-01-04 00:33:11.134632 | 4e5f6800-3a37-41d1-98ea-6b431dd7bb68 ==============================
[0m00:33:11.134668 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:11.135795 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_orders"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:33:11.135185 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:33:11.136634 [debug] [MainThread]: Tracking: tracking
[0m00:33:11.135821 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:33:11.144488 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:33:11.146684 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:33:11.147723 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:33:11.148479 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:33:11.150055 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:33:11.150412 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:33:11.151972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbef820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbef730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbef790>]}
[0m00:33:11.151115 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:33:11.154632 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:33:11.166214 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:33:11.167173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e5f6800-3a37-41d1-98ea-6b431dd7bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbdcb50>]}
[0m00:33:11.170632 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:33:11.188584 [debug] [MainThread]: Parsing macros/drop_table.sql
[0m00:33:11.190346 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
[0m00:33:11.192046 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:33:11.194451 [debug] [MainThread]: Parsing macros/relations.sql
[0m00:33:11.196234 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m00:33:11.196334 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:33:11.199907 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:33:11.202973 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:33:11.207718 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:33:11.209172 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:33:11.216717 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:33:11.232730 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m00:33:11.236031 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m00:33:11.244272 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:33:11.251502 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:33:11.252960 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:33:11.254191 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:33:11.255094 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:33:11.259057 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:33:11.260523 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:33:11.262537 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:33:11.265129 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:33:11.265233 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:33:11.277822 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:33:11.279731 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:33:11.288661 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:33:11.294333 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:33:11.295938 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:33:11.296036 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:33:11.297268 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:33:11.299797 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:33:11.300718 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:33:11.301689 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:33:11.303449 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:33:11.308730 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:33:11.321563 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m00:33:11.323565 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:33:11.325294 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:33:11.328454 [debug] [MainThread]: 1603: static parser failed on orders.sql
[0m00:33:11.332678 [debug] [MainThread]: 1602: parser fallback to jinja rendering on orders.sql
[0m00:33:11.334379 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m00:33:11.335573 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:33:11.337096 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m00:33:11.340079 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m00:33:11.352450 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:33:11.367802 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:33:11.371424 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:33:11.376536 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:33:11.383185 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:33:11.392330 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:33:11.396098 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:33:11.404513 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:33:11.412629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:33:11.429203 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m00:33:11.431918 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:33:11.436307 [debug] [MainThread]: 1603: static parser failed on orders.sql
[0m00:33:11.438604 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:33:11.439976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1c8ffeb-6613-42bb-b7d0-347aa9b0d3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1ca1160>]}
[0m00:33:11.440563 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:33:11.440190 [debug] [MainThread]: 1602: parser fallback to jinja rendering on orders.sql
[0m00:33:11.444307 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m00:33:11.446742 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m00:33:11.447895 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:33:11.448971 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m00:33:11.455064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c8ffeb-6613-42bb-b7d0-347aa9b0d3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c7fee0>]}
[0m00:33:11.457160 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:33:11.457980 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:11.457218 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:33:11.458816 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:33:11.459976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:11.460052 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:33:11.462275 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:33:11.463751 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:33:11.468300 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:11.469366 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:33:11.469447 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:33:11.470350 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:11.471554 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:33:11.471914 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:33:11.473649 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:33:11.474089 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:11.475122 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:33:11.476884 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:33:11.485440 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:33:11.487337 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:33:11.486432 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:11.498608 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_payments
  
[0m00:33:11.497253 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:33:11.499966 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:33:11.500513 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:33:11.502196 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:33:11.502387 [debug] [MainThread]: On macro_drop_table: Close
[0m00:33:11.504402 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:33:11.504539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28a6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c23a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c23bb0>]}
[0m00:33:11.505982 [debug] [MainThread]: Flushing usage events
[0m00:33:11.506377 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:33:11.508028 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:33:11.509490 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:33:11.511082 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:33:11.512252 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:33:11.513631 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:33:11.515298 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:33:11.520164 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:33:11.523898 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:33:11.529878 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:33:11.534244 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:33:11.538248 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:33:11.549017 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:33:11.551398 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:33:11.566470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fcbd11c-96ad-4eea-8914-62e7d24766e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c30af0>]}
[0m00:33:11.566998 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:33:11.577543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fcbd11c-96ad-4eea-8914-62e7d24766e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c3a040>]}
[0m00:33:11.578712 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:33:11.579056 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:33:11.579644 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:11.580611 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:33:11.581368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:11.583324 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:33:11.587639 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:11.588710 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:33:11.589626 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:33:11.590687 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.
[0m00:33:11.591333 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:11.596039 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:33:11.597790 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:11.596234 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:33:11.603917 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:33:11.609217 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:11.613973 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_customers
  
[0m00:33:11.615949 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:33:11.617814 [debug] [MainThread]: On macro_drop_table: Close
[0m00:33:11.619153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d93820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930e9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930e9be0>]}
[0m00:33:11.620261 [debug] [MainThread]: Flushing usage events
[0m00:33:11.666371 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:33:11.680994 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:33:11.683446 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:33:11.684936 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:33:11.698022 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:33:11.699504 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:33:11.701109 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:33:11.702237 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:33:11.703441 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:33:11.721324 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.
[0m00:33:11.839151 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m00:33:11.846941 [debug] [MainThread]: 1603: static parser failed on orders.sql
[0m00:33:11.851621 [debug] [MainThread]: 1602: parser fallback to jinja rendering on orders.sql
[0m00:33:11.856920 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m00:33:11.859180 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m00:33:11.861604 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m00:33:11.956142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e5f6800-3a37-41d1-98ea-6b431dd7bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67fcc910>]}
[0m00:33:11.969333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5f6800-3a37-41d1-98ea-6b431dd7bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c039850>]}
[0m00:33:11.970925 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:33:11.972526 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:11.973665 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:33:11.974881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:11.982016 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:11.983191 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:33:11.984009 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:11.985872 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:33:11.999881 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:12.007416 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:33:12.008402 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_orders
  
[0m00:33:12.009513 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:33:12.013477 [debug] [MainThread]: On macro_drop_table: Close
[0m00:33:12.014738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbef820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f42b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f42cd0>]}
[0m00:33:12.015504 [debug] [MainThread]: Flushing usage events
[0m00:33:12.131550 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.


============================== 2023-01-04 00:33:14.665585 | a951bdab-0ff6-41d2-a020-cb992c59175f ==============================
[0m00:33:14.665606 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:14.666937 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m00:33:14.668253 [debug] [MainThread]: Tracking: tracking
[0m00:33:14.681197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e3d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e3d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e3d7c0>]}
[0m00:33:14.742378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:14.743365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:14.748038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a951bdab-0ff6-41d2-a020-cb992c59175f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c190d0>]}
[0m00:33:14.790325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a951bdab-0ff6-41d2-a020-cb992c59175f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbadff880>]}
[0m00:33:14.791322 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:14.792614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a951bdab-0ff6-41d2-a020-cb992c59175f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbadf0730>]}
[0m00:33:14.794768 [info ] [MainThread]: 
[0m00:33:14.796390 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:14.798212 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:33:14.806387 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:33:14.807462 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:33:14.809329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:14.819308 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:33:14.821409 [debug] [ThreadPool]: On list_postgres: Close
[0m00:33:14.823673 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:14.828493 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:14.829894 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:14.830887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:14.838275 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:14.839552 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:14.840496 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:14.844863 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m00:33:14.847193 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:14.848736 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:14.850096 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:14.852179 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:14.853983 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:14.854988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:14.860113 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:14.861749 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:14.862823 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:14.866013 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:14.867793 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:14.868896 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:14.873230 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:14.874280 [debug] [MainThread]: On master: BEGIN
[0m00:33:14.876475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:14.882232 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:14.883512 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:14.884358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:14.888019 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:14.889586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a951bdab-0ff6-41d2-a020-cb992c59175f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbadfb3d0>]}
[0m00:33:14.890679 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:14.892543 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:14.894172 [debug] [MainThread]: On master: BEGIN
[0m00:33:14.895767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:14.897124 [debug] [MainThread]: On master: COMMIT
[0m00:33:14.898108 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:14.899233 [debug] [MainThread]: On master: COMMIT
[0m00:33:14.900243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:14.901085 [debug] [MainThread]: On master: Close
[0m00:33:14.902285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:14.903298 [info ] [MainThread]: 
[0m00:33:14.913628 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_customers
[0m00:33:14.915724 [info ] [Thread-1  ]: 1 of 3 START seed file public.raw_customers .................................... [RUN]
[0m00:33:14.917271 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_customers"
[0m00:33:14.918312 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_customers
[0m00:33:14.919319 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:14.920112 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_customers
[0m00:33:14.947119 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:33:14.948280 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: BEGIN
[0m00:33:14.949205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:14.956900 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:14.958363 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:33:14.959583 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "postgres"."public"."raw_customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m00:33:14.964070 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:33:15.002023 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:33:15.003227 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: 
          insert into "postgres"."public"."raw_customers" ("id", "first_name", "last_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m00:33:15.004963 [debug] [Thread-1  ]: SQL status: INSERT 0 100 in 0.0 seconds
[0m00:33:15.009256 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m00:33:15.030205 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: COMMIT
[0m00:33:15.031007 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:33:15.031752 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: COMMIT
[0m00:33:15.033004 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:33:15.034086 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:15.034922 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: Close
[0m00:33:15.035964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a951bdab-0ff6-41d2-a020-cb992c59175f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9988130>]}
[0m00:33:15.036822 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file public.raw_customers ................................ [[32mINSERT 100[0m in 0.12s]
[0m00:33:15.037952 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_customers
[0m00:33:15.038841 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_orders
[0m00:33:15.039839 [info ] [Thread-1  ]: 2 of 3 START seed file public.raw_orders ....................................... [RUN]
[0m00:33:15.040985 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_orders"
[0m00:33:15.041772 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_orders
[0m00:33:15.042557 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:15.043294 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_orders
[0m00:33:15.048993 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:33:15.049793 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: BEGIN
[0m00:33:15.050608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:15.055749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:15.056638 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:33:15.057310 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "postgres"."public"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m00:33:15.060724 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:33:15.094847 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:33:15.095748 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: 
          insert into "postgres"."public"."raw_orders" ("id", "user_id", "order_date", "status") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m00:33:15.097634 [debug] [Thread-1  ]: SQL status: INSERT 0 99 in 0.0 seconds
[0m00:33:15.098889 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m00:33:15.103751 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: COMMIT
[0m00:33:15.104623 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:33:15.105446 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: COMMIT
[0m00:33:15.106882 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:33:15.108010 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:15.108850 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: Close
[0m00:33:15.110205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a951bdab-0ff6-41d2-a020-cb992c59175f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8bb7970>]}
[0m00:33:15.111081 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file public.raw_orders ................................... [[32mINSERT 99[0m in 0.07s]
[0m00:33:15.112005 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_orders
[0m00:33:15.112776 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_payments
[0m00:33:15.113668 [info ] [Thread-1  ]: 3 of 3 START seed file public.raw_payments ..................................... [RUN]
[0m00:33:15.114954 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_payments"
[0m00:33:15.115852 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_payments
[0m00:33:15.116727 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:15.117567 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_payments
[0m00:33:15.124413 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:33:15.125225 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: BEGIN
[0m00:33:15.125912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:15.130720 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:15.131834 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:33:15.132768 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "postgres"."public"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer)
  
[0m00:33:15.138865 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
[0m00:33:15.178812 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:33:15.179538 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: 
          insert into "postgres"."public"."raw_payments" ("id", "order_id", "payment_method", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m00:33:15.181772 [debug] [Thread-1  ]: SQL status: INSERT 0 113 in 0.0 seconds
[0m00:33:15.183674 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m00:33:15.188185 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: COMMIT
[0m00:33:15.189058 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:33:15.189857 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: COMMIT
[0m00:33:15.191185 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:33:15.192165 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:15.192868 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: Close
[0m00:33:15.193852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a951bdab-0ff6-41d2-a020-cb992c59175f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8340fd0>]}
[0m00:33:15.194670 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file public.raw_payments ................................. [[32mINSERT 113[0m in 0.08s]
[0m00:33:15.195903 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_payments
[0m00:33:15.197392 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:15.198496 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:15.200103 [debug] [MainThread]: On master: BEGIN
[0m00:33:15.200820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:15.206266 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:15.207258 [debug] [MainThread]: On master: COMMIT
[0m00:33:15.208080 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:15.208759 [debug] [MainThread]: On master: COMMIT
[0m00:33:15.209567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:15.210285 [debug] [MainThread]: On master: Close
[0m00:33:15.211205 [info ] [MainThread]: 
[0m00:33:15.212199 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m00:33:15.213074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:15.213897 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m00:33:15.223919 [info ] [MainThread]: 
[0m00:33:15.224736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:15.225523 [info ] [MainThread]: 
[0m00:33:15.226129 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:33:15.226838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba56eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99b9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8b73dc0>]}
[0m00:33:15.227615 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:33:29.485569 | 2e588e7e-153b-4742-82b9-706b68a22fdd ==============================
[0m00:33:29.485592 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:29.486710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_payments'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:29.487894 [debug] [MainThread]: Tracking: tracking


============================== 2023-01-04 00:33:29.488591 | ea8277e1-fa26-4131-85dd-1a479be70c1b ==============================
[0m00:33:29.488629 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:29.491773 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:29.492759 [debug] [MainThread]: Tracking: tracking
[0m00:33:29.503361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e94850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e94760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e947c0>]}
[0m00:33:29.523803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d095850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d095760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0957c0>]}


============================== 2023-01-04 00:33:29.524086 | 75a77397-9502-497c-834a-574613352853 ==============================
[0m00:33:29.524150 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:29.525738 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:29.526387 [debug] [MainThread]: Tracking: tracking
[0m00:33:29.548237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d971880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d971790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9717f0>]}


============================== 2023-01-04 00:33:29.556608 | e8956f0c-0412-4afc-8c23-97023191fdfb ==============================
[0m00:33:29.556624 [info ] [MainThread]: Running with dbt=1.3.1


============================== 2023-01-04 00:33:29.556452 | 11d007c8-264c-4f52-957f-f8e4e4ec1087 ==============================
[0m00:33:29.556508 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:29.557742 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:29.559105 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:29.559625 [debug] [MainThread]: Tracking: tracking
[0m00:33:29.560371 [debug] [MainThread]: Tracking: tracking
[0m00:33:29.581254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72fd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72fd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72fd7c0>]}
[0m00:33:29.584779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8af850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8af760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8af7c0>]}
[0m00:33:29.585567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:29.587058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:29.592259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e588e7e-153b-4742-82b9-706b68a22fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c6f0d0>]}
[0m00:33:29.625197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:29.626387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:29.630696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:29.631684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:29.634901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a77397-9502-497c-834a-574613352853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d74d0d0>]}
[0m00:33:29.636851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea8277e1-fa26-4131-85dd-1a479be70c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce710d0>]}
[0m00:33:29.647311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:29.648304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:29.654774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8956f0c-0412-4afc-8c23-97023191fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f68b0d0>]}
[0m00:33:29.660439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e588e7e-153b-4742-82b9-706b68a22fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e5ed90>]}
[0m00:33:29.661684 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:29.662911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e588e7e-153b-4742-82b9-706b68a22fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e57d90>]}
[0m00:33:29.667974 [info ] [MainThread]: 
[0m00:33:29.669683 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:29.673339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:29.676202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:29.681218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11d007c8-264c-4f52-957f-f8e4e4ec1087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70d90d0>]}
[0m00:33:29.682597 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:33:29.690466 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:33:29.695775 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:33:29.696593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.703696 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:33:29.705806 [debug] [ThreadPool]: On list_postgres: Close
[0m00:33:29.708651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8956f0c-0412-4afc-8c23-97023191fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ff0790>]}
[0m00:33:29.709162 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:29.709814 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:29.713364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8956f0c-0412-4afc-8c23-97023191fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818704f0>]}
[0m00:33:29.713833 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.715161 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:29.716624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.716719 [info ] [MainThread]: 
[0m00:33:29.717361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea8277e1-fa26-4131-85dd-1a479be70c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f05fd90>]}
[0m00:33:29.720614 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:29.720592 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:29.722608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea8277e1-fa26-4131-85dd-1a479be70c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f058d90>]}
[0m00:33:29.724963 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:33:29.724764 [info ] [MainThread]: 
[0m00:33:29.725896 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.727576 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:29.727703 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.725717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a77397-9502-497c-834a-574613352853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f92ef10>]}
[0m00:33:29.732112 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:29.729044 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:33:29.733295 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:29.733157 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:33:29.735365 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:33:29.735849 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m00:33:29.736293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.735588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a77397-9502-497c-834a-574613352853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0bccd0>]}
[0m00:33:29.736676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11d007c8-264c-4f52-957f-f8e4e4ec1087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a3e790>]}
[0m00:33:29.739910 [info ] [MainThread]: 
[0m00:33:29.737982 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:29.742897 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:29.741671 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:29.740722 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:29.741549 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:33:29.745525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d007c8-264c-4f52-957f-f8e4e4ec1087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92be4f0>]}
[0m00:33:29.743830 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:29.745780 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:33:29.743685 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:33:29.746221 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:33:29.748945 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.748473 [info ] [MainThread]: 
[0m00:33:29.749084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.750184 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:29.750988 [debug] [ThreadPool]: On list_postgres: Close
[0m00:33:29.754333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:29.750809 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:29.757366 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:29.757403 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:33:29.759614 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:33:29.760684 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:33:29.761032 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.762415 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.761691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.762038 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.763237 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:29.764377 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m00:33:29.764169 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:29.766341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.766997 [debug] [ThreadPool]: On list_postgres: Close
[0m00:33:29.767095 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.769233 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:29.770783 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:29.771037 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:29.770414 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:33:29.774334 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:33:29.774635 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:33:29.776195 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.777952 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.776733 [debug] [ThreadPool]: On list_postgres: Close
[0m00:33:29.776874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.777766 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.777820 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.778829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:29.781991 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.780966 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:29.782419 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:29.784101 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:29.788105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.787506 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.788311 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.787857 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:33:29.791348 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.792818 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:29.791483 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m00:33:29.796001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:29.794888 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:29.798216 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:29.795376 [debug] [ThreadPool]: On list_postgres: Close
[0m00:33:29.796686 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.801728 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:29.802754 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.804263 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:29.803560 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:29.806472 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.807707 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:29.806573 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.808908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:29.809457 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:29.807520 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.810051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e588e7e-153b-4742-82b9-706b68a22fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a01700>]}
[0m00:33:29.808393 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.812393 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:29.812740 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:29.813756 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.812817 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.814848 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:29.814766 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.815861 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:29.815358 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.817023 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.817085 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.820657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:29.817077 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:29.821208 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:29.822494 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.821430 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m00:33:29.821980 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:29.824658 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.844231 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.825666 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.845393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:29.846278 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:29.846340 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:29.846999 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.848057 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:29.848957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:29.850819 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close


============================== 2023-01-04 00:33:29.851212 | 3404704c-03a7-4103-8790-4068d1c8ccb4 ==============================
[0m00:33:29.851234 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:29.852649 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.851340 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:29.849875 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:29.855845 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.856308 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_payments'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:29.855911 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.858061 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:29.858439 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.856784 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.857368 [debug] [MainThread]: On master: Close
[0m00:33:29.859232 [debug] [MainThread]: Tracking: tracking
[0m00:33:29.864112 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:29.860093 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:29.864861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:29.863675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:29.863718 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.867524 [info ] [MainThread]: 
[0m00:33:29.866722 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:29.872356 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m00:33:29.874531 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.875527 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.876596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:29.868759 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:29.872257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafddd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafddd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafddd7c0>]}
[0m00:33:29.880118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:29.874533 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:29.869002 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m00:33:29.879900 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.880156 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_payments
[0m00:33:29.885473 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:29.885698 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.886980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8956f0c-0412-4afc-8c23-97023191fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8040f580>]}
[0m00:33:29.889320 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:29.890483 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.887023 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:29.893081 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:29.890959 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.888108 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.887049 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_payments ................................ [RUN]
[0m00:33:29.891981 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.894264 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:29.894983 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.895669 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:29.896663 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:29.899670 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.896493 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:29.897797 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.900815 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.897884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:29.900568 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.901370 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_payments
[0m00:33:29.901707 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:29.903671 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.902905 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:29.904540 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_payments
[0m00:33:29.905321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:29.906513 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:29.906789 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:29.907929 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.909597 [debug] [MainThread]: On master: Close
[0m00:33:29.910635 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.913670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:29.912628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:29.910561 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m00:33:29.916323 [info ] [MainThread]: 
[0m00:33:29.917587 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.913239 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.918033 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.919116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea8277e1-fa26-4131-85dd-1a479be70c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbe0160>]}
[0m00:33:29.919650 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.920594 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:29.921439 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:29.923214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:29.923806 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:29.924750 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.927319 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.927561 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_orders
[0m00:33:29.928672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:29.929886 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.929268 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_orders .................................. [RUN]
[0m00:33:29.928605 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.931679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:29.931388 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.932917 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:29.931758 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.933512 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:29.933564 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:29.933646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:29.934569 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.935344 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_orders
[0m00:33:29.935924 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.936739 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:29.938624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:29.937356 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_payments
[0m00:33:29.939823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:29.944038 [debug] [MainThread]: On master: Close
[0m00:33:29.942847 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.939242 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_orders
[0m00:33:29.941669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3404704c-03a7-4103-8790-4068d1c8ccb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafbb90d0>]}
[0m00:33:29.945959 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.945205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:29.948071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:29.949048 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m00:33:29.950406 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m00:33:29.949034 [info ] [MainThread]: 
[0m00:33:29.952825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a77397-9502-497c-834a-574613352853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4d1070>]}
[0m00:33:29.955064 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:29.953678 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:29.956078 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.957062 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.957766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:29.956896 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:29.958533 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.960048 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_orders
[0m00:33:29.962235 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:29.965673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d007c8-264c-4f52-957f-f8e4e4ec1087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e5d580>]}
[0m00:33:29.962384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:29.967181 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.966980 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:29.968208 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.969538 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.969555 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m00:33:29.970002 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.970915 [debug] [MainThread]: On master: BEGIN
[0m00:33:29.972989 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:29.973560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:29.975419 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m00:33:29.974955 [debug] [MainThread]: On master: Close
[0m00:33:29.976691 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_customers ............................... [RUN]
[0m00:33:29.977617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:29.975881 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.978171 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:29.978534 [info ] [MainThread]: 
[0m00:33:29.979744 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m00:33:29.978830 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:29.981208 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m00:33:29.988327 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:29.981751 [debug] [MainThread]: On master: COMMIT
[0m00:33:29.986647 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m00:33:29.989092 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: BEGIN
[0m00:33:29.986108 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m00:33:29.989787 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:29.990669 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:29.991983 [debug] [MainThread]: On master: Close
[0m00:33:29.991347 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m00:33:29.994565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:29.994480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3404704c-03a7-4103-8790-4068d1c8ccb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0911f10>]}
[0m00:33:29.994714 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_customers ............................... [RUN]
[0m00:33:29.993627 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:29.997791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.006103 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.006793 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:30.009306 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.006172 [info ] [MainThread]: 
[0m00:33:30.010367 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m00:33:30.009320 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m00:33:30.011840 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m00:33:30.009974 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.012908 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:30.011170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3404704c-03a7-4103-8790-4068d1c8ccb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d9e0d0>]}
[0m00:33:30.014322 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m00:33:30.017190 [info ] [MainThread]: 
[0m00:33:30.014797 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "postgres"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m00:33:30.019038 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:30.019376 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m00:33:30.021575 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:33:30.022068 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.024736 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.025641 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "postgres"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m00:33:30.022846 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:33:30.027389 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.028017 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.029369 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_orders
[0m00:33:30.029447 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:33:30.030215 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m00:33:30.029575 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m00:33:30.033006 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:33:30.036161 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:33:30.037253 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:33:30.037020 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.037994 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m00:33:30.031466 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_orders .................................. [RUN]
[0m00:33:30.039006 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:33:30.038625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:30.042391 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.045182 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.044080 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:33:30.044781 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m00:33:30.045981 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_orders
[0m00:33:30.046882 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m00:33:30.051105 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:33:30.052110 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.053247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:30.052707 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_orders
[0m00:33:30.054496 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m00:33:30.054838 [debug] [ThreadPool]: On list_postgres: Close
[0m00:33:30.054884 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m00:33:30.057704 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.058929 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m00:33:30.060404 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.059991 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.059997 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:30.061704 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m00:33:30.062497 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m00:33:30.062320 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.062627 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.064819 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.062666 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.068567 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "postgres"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m00:33:30.065705 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "postgres"."public"."stg_payments__dbt_backup" cascade
[0m00:33:30.066020 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m00:33:30.066885 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:30.070366 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:33:30.068825 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.069981 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.070447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:30.071082 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:33:30.072609 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_orders
[0m00:33:30.072670 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.075979 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: Close
[0m00:33:30.077328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e588e7e-153b-4742-82b9-706b68a22fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7cdaa60>]}
[0m00:33:30.078503 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_payments ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m00:33:30.079722 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_payments
[0m00:33:30.071269 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:30.081289 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:30.073320 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "postgres"."public"."stg_orders__dbt_backup" cascade
[0m00:33:30.081630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:30.080235 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.082480 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.081323 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.083519 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:33:30.085356 [debug] [MainThread]: On master: BEGIN
[0m00:33:30.084476 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.085878 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:33:30.087654 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.087864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:30.089391 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:33:30.088450 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "postgres"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m00:33:30.091042 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: Close
[0m00:33:30.088655 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.096791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956f0c-0412-4afc-8c23-97023191fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6af4c0>]}
[0m00:33:30.098004 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m00:33:30.099130 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.097595 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:30.098772 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m00:33:30.100558 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.101356 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:30.102522 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.103214 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.103128 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_orders
[0m00:33:30.104767 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m00:33:30.105449 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.105221 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m00:33:30.106567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:30.106935 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m00:33:30.106755 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:30.107449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.107557 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.110481 [debug] [MainThread]: On master: Close
[0m00:33:30.110055 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:30.109863 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.110981 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m00:33:30.112166 [info ] [MainThread]: 
[0m00:33:30.114056 [debug] [MainThread]: On master: BEGIN
[0m00:33:30.113762 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:30.115767 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.116888 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
[0m00:33:30.115485 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m00:33:30.117222 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:30.117808 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.115961 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.119823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:30.116268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:30.121577 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:33:30.120891 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "postgres"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m00:33:30.122072 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.121230 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:30.123048 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m00:33:30.124965 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:33:30.126869 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "postgres"."public"."stg_customers__dbt_backup" cascade
[0m00:33:30.125036 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:33:30.126596 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.125404 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:30.126392 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:33:30.129188 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "stg_customers" already exists

[0m00:33:30.128226 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:33:30.129977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:30.129594 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.132440 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m00:33:30.135335 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.133561 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.134346 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:33:30.138435 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:33:30.136593 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m00:33:30.137157 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.138865 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.137863 [info ] [MainThread]: 
[0m00:33:30.139495 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m00:33:30.137668 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m00:33:30.139642 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "stg_orders" already exists

[0m00:33:30.139896 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.141035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:30.142680 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: ROLLBACK
[0m00:33:30.140421 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:30.143532 [debug] [MainThread]: On master: Close
[0m00:33:30.144452 [info ] [MainThread]: 
[0m00:33:30.141588 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.142365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea8277e1-fa26-4131-85dd-1a479be70c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cee4fd0>]}
[0m00:33:30.149873 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:33:30.151227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a5ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a00160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b6b160>]}
[0m00:33:30.146645 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:30.146488 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m00:33:30.150109 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m00:33:30.147757 [info ] [MainThread]: 
[0m00:33:30.150565 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m00:33:30.151927 [debug] [MainThread]: Flushing usage events
[0m00:33:30.154201 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:30.152862 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m00:33:30.153888 [debug] [Thread-1  ]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "stg_customers" already exists
  compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m00:33:30.155741 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m00:33:30.155346 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m00:33:30.157994 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.157867 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:30.158682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a77397-9502-497c-834a-574613352853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6e87c0>]}
[0m00:33:30.159640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:30.160124 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:30.160768 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: Close
[0m00:33:30.163652 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:30.165376 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.166302 [debug] [Thread-1  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "stg_orders" already exists
  compiled Code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m00:33:30.164772 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.15s]
[0m00:33:30.164939 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:33:30.168367 [debug] [MainThread]: On master: BEGIN
[0m00:33:30.169781 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m00:33:30.169824 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m00:33:30.169339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d007c8-264c-4f52-957f-f8e4e4ec1087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70747c0>]}
[0m00:33:30.171358 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.170450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:30.172329 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_orders ......................... [[31mERROR[0m in 0.13s]
[0m00:33:30.172029 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:30.172847 [debug] [MainThread]: On master: BEGIN
[0m00:33:30.176677 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_orders
[0m00:33:30.177022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:30.176516 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.181624 [debug] [MainThread]: On master: BEGIN
[0m00:33:30.181663 [info ] [MainThread]: 
[0m00:33:30.180516 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:30.178404 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.182451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:30.183148 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.183515 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.185962 [debug] [MainThread]: On master: BEGIN
[0m00:33:30.187482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:30.182916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:30.186319 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.186676 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.189373 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.189290 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.189043 [info ] [MainThread]: 
[0m00:33:30.189925 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.191854 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.191062 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:30.192964 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.192937 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.198049 [debug] [MainThread]: On master: Close
[0m00:33:30.192497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:33:30.194673 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.193577 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.200257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803e6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80492dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f616790>]}
[0m00:33:30.199727 [info ] [MainThread]: 
[0m00:33:30.200664 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.201046 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.202987 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.202213 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:33:30.201910 [debug] [MainThread]: Flushing usage events
[0m00:33:30.205380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:30.202187 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:33:30.206470 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:33:30.203690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.204585 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.207597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3404704c-03a7-4103-8790-4068d1c8ccb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0962a60>]}
[0m00:33:30.209040 [debug] [MainThread]: On master: Close
[0m00:33:30.208227 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m00:33:30.211984 [info ] [MainThread]: 
[0m00:33:30.209796 [debug] [MainThread]: On master: Close
[0m00:33:30.213490 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:33:30.210660 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:30.214684 [info ] [MainThread]: 
[0m00:33:30.216011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:30.216641 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.217443 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m00:33:30.218509 [debug] [MainThread]: On master: BEGIN
[0m00:33:30.218041 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m00:33:30.221656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:30.220652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:30.224381 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.225023 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m00:33:30.225777 [info ] [MainThread]: 
[0m00:33:30.225948 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.226978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:30.228898 [info ] [MainThread]: 
[0m00:33:30.227569 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.229815 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:33:30.232167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc5ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0cfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdfb820>]}
[0m00:33:30.230088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.234235 [debug] [MainThread]: Flushing usage events
[0m00:33:30.235796 [debug] [MainThread]: On master: Close
[0m00:33:30.237677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:30.239057 [info ] [MainThread]: 
[0m00:33:30.242836 [info ] [MainThread]: 
[0m00:33:30.242820 [info ] [MainThread]: 
[0m00:33:30.244490 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:33:30.245003 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:33:30.246433 [info ] [MainThread]: 
[0m00:33:30.245714 [info ] [MainThread]: 
[0m00:33:30.246851 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/staging/stg_orders.sql)[0m
[0m00:33:30.247088 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/staging/stg_customers.sql)[0m
[0m00:33:30.247828 [error] [MainThread]:   relation "stg_orders" already exists
[0m00:33:30.248950 [error] [MainThread]:   relation "stg_customers" already exists
[0m00:33:30.249794 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m00:33:30.249470 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m00:33:30.251363 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_payments
[0m00:33:30.250695 [info ] [MainThread]: 
[0m00:33:30.252235 [info ] [MainThread]: 
[0m00:33:30.253561 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_payments ................................ [RUN]
[0m00:33:30.253944 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:33:30.254354 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:33:30.255514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4a18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4a8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6d53a0>]}
[0m00:33:30.255405 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.256518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7339e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e34430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7061490>]}
[0m00:33:30.257075 [debug] [MainThread]: Flushing usage events
[0m00:33:30.257408 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_payments
[0m00:33:30.259252 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_payments
[0m00:33:30.258185 [debug] [MainThread]: Flushing usage events
[0m00:33:30.262362 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m00:33:30.265184 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.266589 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_payments
[0m00:33:30.289367 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m00:33:30.293202 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.294383 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: BEGIN
[0m00:33:30.295336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:30.300921 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:30.302019 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.302990 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "postgres"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m00:33:30.305605 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:33:30.311233 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.312511 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."public"."stg_payments" rename to "stg_payments__dbt_backup"
[0m00:33:30.314422 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:33:30.317179 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.318496 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m00:33:30.320053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:33:30.331411 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m00:33:30.332905 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.333784 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m00:33:30.335602 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.339435 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:33:30.340419 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "postgres"."public"."stg_payments__dbt_backup" cascade
[0m00:33:30.342974 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:33:30.344727 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:30.345589 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: Close
[0m00:33:30.346756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3404704c-03a7-4103-8790-4068d1c8ccb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafbdc4f0>]}
[0m00:33:30.347728 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_payments ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m00:33:30.348990 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_payments
[0m00:33:30.350650 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:30.351584 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.352222 [debug] [MainThread]: On master: BEGIN
[0m00:33:30.352760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:30.357574 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:30.358451 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.364306 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:30.365111 [debug] [MainThread]: On master: COMMIT
[0m00:33:30.366304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:30.367555 [debug] [MainThread]: On master: Close
[0m00:33:30.368958 [info ] [MainThread]: 
[0m00:33:30.372850 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m00:33:30.374293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:30.375465 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m00:33:30.399092 [info ] [MainThread]: 
[0m00:33:30.400905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:30.402000 [info ] [MainThread]: 
[0m00:33:30.402693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:33:30.403575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0962fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0961d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc924c0>]}
[0m00:33:30.404629 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:33:32.100801 | f2d7ad0c-9b6d-4f87-a4b8-de55039717ef ==============================
[0m00:33:32.100830 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:32.101699 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_orders'], 'which': 'test', 'rpc_method': 'test'}


============================== 2023-01-04 00:33:32.100850 | 358d2ac6-2a49-4a0a-bc70-8df7488928d8 ==============================
[0m00:33:32.100893 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:32.102990 [debug] [MainThread]: Tracking: tracking
[0m00:33:32.104421 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_payments'], 'which': 'test', 'rpc_method': 'test'}
[0m00:33:32.105388 [debug] [MainThread]: Tracking: tracking
[0m00:33:32.112381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862c2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862c2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862c27c0>]}
[0m00:33:32.124874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c01850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c01760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c017c0>]}


============================== 2023-01-04 00:33:32.152629 | 8076e695-2ec5-42a2-aec8-efc4d5bc66ea ==============================
[0m00:33:32.152667 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:32.156224 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_customers'], 'which': 'test', 'rpc_method': 'test'}
[0m00:33:32.159887 [debug] [MainThread]: Tracking: tracking
[0m00:33:32.177995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51cc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51cc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51cc7c0>]}
[0m00:33:32.180717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:32.182078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:32.187821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '358d2ac6-2a49-4a0a-bc70-8df7488928d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39dc0d0>]}
[0m00:33:32.188292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:32.194261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:32.198912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2d7ad0c-9b6d-4f87-a4b8-de55039717ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8609f0d0>]}
[0m00:33:32.227397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '358d2ac6-2a49-4a0a-bc70-8df7488928d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bcbd90>]}
[0m00:33:32.227808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:32.229156 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:32.228475 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:32.230624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358d2ac6-2a49-4a0a-bc70-8df7488928d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bc4d90>]}
[0m00:33:32.232367 [info ] [MainThread]: 
[0m00:33:32.233984 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:32.234124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8076e695-2ec5-42a2-aec8-efc4d5bc66ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fa80d0>]}
[0m00:33:32.236458 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:32.243999 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:32.245091 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:32.245868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:32.247459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2d7ad0c-9b6d-4f87-a4b8-de55039717ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e9ff40>]}
[0m00:33:32.248465 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:32.249494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2d7ad0c-9b6d-4f87-a4b8-de55039717ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8828f3d0>]}
[0m00:33:32.251505 [info ] [MainThread]: 
[0m00:33:32.253545 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:32.252109 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.256159 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:32.256412 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:32.257045 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:32.260942 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:32.262711 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:32.263771 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:32.264368 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:32.265656 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:32.266479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:32.265957 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:32.270464 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:32.271537 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:32.272327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:32.272847 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.274272 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:32.275235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8076e695-2ec5-42a2-aec8-efc4d5bc66ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa690c790>]}
[0m00:33:32.275236 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:32.276221 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:32.277927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8076e695-2ec5-42a2-aec8-efc4d5bc66ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa718d4f0>]}
[0m00:33:32.277838 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.279055 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:33:32.279665 [info ] [MainThread]: 
[0m00:33:32.279663 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:32.281883 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:32.281613 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:32.282357 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:32.282865 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:32.284062 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:32.285936 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:33:32.287947 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:32.288960 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:32.291865 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:32.292784 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.285130 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:32.294668 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:32.295167 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.296737 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:32.296246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:32.296872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:32.297627 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:32.300129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:32.303311 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.303550 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.304336 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.304981 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:32.305906 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.305689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:32.306467 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:32.307060 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:32.309093 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:32.311374 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:32.312909 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:32.312898 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:33:32.313855 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:32.314495 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:32.316111 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:32.317122 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:32.317908 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:32.318097 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:32.318896 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:32.315472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358d2ac6-2a49-4a0a-bc70-8df7488928d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa474ca90>]}
[0m00:33:32.321237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:32.323230 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.323601 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:32.325150 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.326070 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.326485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:32.326965 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.330634 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:32.330789 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.332443 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.333911 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.333154 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:32.333960 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.335033 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:32.334760 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.337004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:32.335949 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.338325 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:33:32.338532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:32.340600 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:32.340968 [debug] [MainThread]: On master: Close
[0m00:33:32.341858 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:32.343213 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:33:32.342716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:32.346890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2d7ad0c-9b6d-4f87-a4b8-de55039717ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ad30a0>]}
[0m00:33:32.346954 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.347315 [info ] [MainThread]: 
[0m00:33:32.347890 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:32.348180 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.349649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:32.349574 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.351296 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.352427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:32.353223 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.354011 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.354645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:32.355343 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.354811 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.355955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:32.356691 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:32.357729 [debug] [MainThread]: On master: Close
[0m00:33:32.358442 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:32.359360 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [RUN]
[0m00:33:32.358916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:32.361034 [info ] [MainThread]: 
[0m00:33:32.360435 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:32.362707 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:32.362156 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:33:32.363685 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:32.365164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8076e695-2ec5-42a2-aec8-efc4d5bc66ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d2cf40>]}
[0m00:33:32.366090 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:32.367013 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.367850 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.368955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:32.369743 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.370397 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.371172 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.372023 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:32.372899 [debug] [MainThread]: On master: Close
[0m00:33:32.373543 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:32.374110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:32.374688 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:33:32.375608 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m00:33:32.375759 [info ] [MainThread]: 
[0m00:33:32.377196 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:33:32.378294 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:33:32.379119 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:33:32.382057 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.382959 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:32.386973 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:33:32.387866 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m00:33:32.388982 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:33:32.389852 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:33:32.389435 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:33:32.390638 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:33:32.393198 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:32.398466 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:33:32.400034 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.400870 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:33:32.401663 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.402724 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:33:32.405951 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:32.406937 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: BEGIN
[0m00:33:32.407664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:32.410752 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:33:32.412428 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:33:32.412635 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:32.414115 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:32.415511 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "postgres"."public"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m00:33:32.416104 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:33:32.418987 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m00:33:32.419093 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:33:32.419465 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:32.420569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:32.422904 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.421071 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m00:33:32.424557 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
[0m00:33:32.425060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:32.426081 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
[0m00:33:32.427943 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [[32mPASS[0m in 0.07s]
[0m00:33:32.429158 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.429910 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:32.430546 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:33:32.431199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.431624 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:32.432755 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:33:32.431857 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."public"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m00:33:32.433576 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_payments_payment_id ............................. [RUN]
[0m00:33:32.434241 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:33:32.436356 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:32.437110 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:32.438594 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:32.439771 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.438905 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:32.440602 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m00:33:32.441005 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.441908 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:32.443187 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m00:33:32.443760 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m00:33:32.445871 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m00:33:32.447009 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m00:33:32.445002 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.07s]
[0m00:33:32.448394 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:33:32.449525 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:33:32.450238 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:33:32.451644 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_customers_customer_id ............................. [RUN]
[0m00:33:32.451254 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:32.451193 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:33:32.452952 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:33:32.453565 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_orders_order_id ................................. [RUN]
[0m00:33:32.454574 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:33:32.455537 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.456042 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:33:32.457303 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:32.456891 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:33:32.460806 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:32.457954 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:33:32.463204 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:33:32.465046 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:32.465652 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m00:33:32.466247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:32.463537 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:33:32.468283 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:33:32.471632 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.472406 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:33:32.472547 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.474213 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.474215 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:32.474776 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:33:32.475271 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:33:32.476344 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m00:33:32.479178 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:33:32.479752 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:33:32.479699 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:32.481029 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m00:33:32.482549 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.482446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:32.482708 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:33:32.483457 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m00:33:32.486422 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m00:33:32.489624 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m00:33:32.490272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:32.490541 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.491487 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_payments_payment_id ................................... [[32mPASS[0m in 0.05s]
[0m00:33:32.492207 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:33:32.493531 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:32.494814 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:32.494052 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:33:32.496476 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.497413 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:33:32.495743 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_payments_payment_id ............................... [RUN]
[0m00:33:32.497697 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:32.500647 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.499654 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:32.498347 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres"."public"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m00:33:32.502222 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:32.501480 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m00:33:32.503644 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:32.504247 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m00:33:32.504164 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:32.505597 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.05s]
[0m00:33:32.506986 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.508087 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:33:32.508913 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m00:33:32.509873 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:32.511260 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m00:33:32.510802 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:32.512488 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.513208 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.512184 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.06s]
[0m00:33:32.514072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:32.514721 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:33:32.515979 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.517928 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:33:32.519315 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:32.520083 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_orders_order_id ................................... [RUN]
[0m00:33:32.521503 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.522555 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.522646 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:33:32.522770 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:32.523486 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.524214 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:33:32.525495 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.526155 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:33:32.527013 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:32.526807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:32.527957 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: BEGIN
[0m00:33:32.528235 [debug] [MainThread]: On master: Close
[0m00:33:32.528997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:32.529916 [info ] [MainThread]: 
[0m00:33:32.531242 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:33:32.532476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:32.533098 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:33:32.533326 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m00:33:32.535756 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.536796 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:32.536882 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.538589 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:33:32.537678 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:33:32.540689 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:33:32.541315 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:32.543713 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.544863 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m00:33:32.545756 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:33:32.545921 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m00:33:32.546703 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m00:33:32.547834 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_payments_payment_id ..................................... [[32mPASS[0m in 0.05s]
[0m00:33:32.546758 [info ] [MainThread]: 
[0m00:33:32.548098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:32.549879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:32.549166 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:32.552986 [info ] [MainThread]: 
[0m00:33:32.554580 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:33:32.554893 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:32.555750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46aad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46aabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fda9a0>]}
[0m00:33:32.557335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.556406 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.557281 [debug] [MainThread]: Flushing usage events
[0m00:33:32.557906 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:33:32.558307 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.560246 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:33:32.560648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:32.563644 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:32.565644 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:32.566575 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m00:33:32.567375 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.567608 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m00:33:32.568312 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.569521 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.569630 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.05s]
[0m00:33:32.570427 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.571458 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:33:32.571866 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:32.573075 [debug] [MainThread]: On master: Close
[0m00:33:32.573310 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:32.574245 [info ] [MainThread]: 
[0m00:33:32.574696 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.575379 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m00:33:32.575982 [debug] [MainThread]: On master: BEGIN
[0m00:33:32.577190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:32.576928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:32.578982 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m00:33:32.582453 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:32.583397 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.584218 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:32.585096 [debug] [MainThread]: On master: COMMIT
[0m00:33:32.586123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:32.587671 [debug] [MainThread]: On master: Close
[0m00:33:32.589155 [info ] [MainThread]: 
[0m00:33:32.590179 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m00:33:32.591339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:32.592266 [info ] [MainThread]: 
[0m00:33:32.592598 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:33:32.593562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:32.595124 [info ] [MainThread]: 
[0m00:33:32.596040 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:33:32.597327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30e0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30e0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3987c70>]}
[0m00:33:32.598289 [debug] [MainThread]: Flushing usage events
[0m00:33:32.605328 [info ] [MainThread]: 
[0m00:33:32.606693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:32.607715 [info ] [MainThread]: 
[0m00:33:32.608767 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:33:32.609878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86050f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8603b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8603b100>]}
[0m00:33:32.610882 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:33:33.341760 | a8f3c678-bca9-4617-878a-c3a80c38fe0c ==============================
[0m00:33:33.341787 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:33.343874 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_payments'], 'which': 'test', 'rpc_method': 'test'}
[0m00:33:33.344724 [debug] [MainThread]: Tracking: tracking
[0m00:33:33.350852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8a6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8a6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8a67c0>]}
[0m00:33:33.397638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:33.398849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:33.403950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8f3c678-bca9-4617-878a-c3a80c38fe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6830d0>]}
[0m00:33:33.450263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8f3c678-bca9-4617-878a-c3a80c38fe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e870d90>]}
[0m00:33:33.451955 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:33.454433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8f3c678-bca9-4617-878a-c3a80c38fe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e869d90>]}
[0m00:33:33.466899 [info ] [MainThread]: 
[0m00:33:33.469155 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:33.471107 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:33.478522 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:33.479778 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:33.480804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:33.488399 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:33.489472 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:33.490441 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:33.493765 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:33:33.496130 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:33.497413 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:33.499061 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:33.501164 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:33.502220 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:33.503177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:33.508154 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:33:33.509109 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:33.510332 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:33.513238 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:33.514798 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:33.516002 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:33.519776 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:33.520839 [debug] [MainThread]: On master: BEGIN
[0m00:33:33.521776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:33.526760 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:33.527900 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:33.528782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:33.534837 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:33:33.536684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8f3c678-bca9-4617-878a-c3a80c38fe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3f1a90>]}
[0m00:33:33.537664 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:33.538771 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:33.539543 [debug] [MainThread]: On master: BEGIN
[0m00:33:33.540860 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:33.541783 [debug] [MainThread]: On master: COMMIT
[0m00:33:33.542544 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:33.543877 [debug] [MainThread]: On master: COMMIT
[0m00:33:33.545354 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:33.546373 [debug] [MainThread]: On master: Close
[0m00:33:33.547737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:33.548705 [info ] [MainThread]: 
[0m00:33:33.559631 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:33.560713 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [RUN]
[0m00:33:33.562181 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:33.563079 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:33.563951 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:33.572500 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:33.576161 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:33.577081 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:33.586737 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:33.590046 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:33.591089 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: BEGIN
[0m00:33:33.591852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:33.597349 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:33.598204 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:33:33.598971 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "postgres"."public"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m00:33:33.601129 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:33.602885 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:33.603687 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
[0m00:33:33.604508 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
[0m00:33:33.605887 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [[32mPASS[0m in 0.04s]
[0m00:33:33.606989 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:33:33.607918 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:33.608662 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_payments_payment_id ............................. [RUN]
[0m00:33:33.609552 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:33.610408 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:33.611196 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:33.616281 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:33.619057 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:33.619918 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:33.621958 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:33.632461 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:33.633833 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m00:33:33.634878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:33.640123 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:33.641002 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:33:33.641819 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m00:33:33.644115 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:33.645671 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:33.646568 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m00:33:33.647412 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m00:33:33.648658 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_payments_payment_id ................................... [[32mPASS[0m in 0.04s]
[0m00:33:33.649654 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:33:33.650400 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:33.654574 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_payments_payment_id ............................... [RUN]
[0m00:33:33.655830 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:33.656707 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:33.657606 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:33.682534 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:33.686472 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:33.687363 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:33.689919 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:33.692692 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:33.693617 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: BEGIN
[0m00:33:33.694400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:33.699588 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:33.700692 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:33:33.701607 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:33:33.703852 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:33.705569 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:33.706464 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m00:33:33.707500 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m00:33:33.708664 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_payments_payment_id ..................................... [[32mPASS[0m in 0.05s]
[0m00:33:33.709767 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:33:33.711524 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:33.712471 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:33.713305 [debug] [MainThread]: On master: BEGIN
[0m00:33:33.714102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:33.719205 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:33.720036 [debug] [MainThread]: On master: COMMIT
[0m00:33:33.720693 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:33.721388 [debug] [MainThread]: On master: COMMIT
[0m00:33:33.722206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:33.722889 [debug] [MainThread]: On master: Close
[0m00:33:33.723905 [info ] [MainThread]: 
[0m00:33:33.724758 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m00:33:33.725646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:33.726401 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m00:33:33.736208 [info ] [MainThread]: 
[0m00:33:33.737072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:33.737825 [info ] [MainThread]: 
[0m00:33:33.738517 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:33:33.739291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c615ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c615ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c615d90>]}
[0m00:33:33.739984 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:33:35.936538 | 76c1ab43-a39a-40d2-9c24-9749b770a9f3 ==============================
[0m00:33:35.936562 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:35.937546 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:35.939018 [debug] [MainThread]: Tracking: tracking
[0m00:33:35.944409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970d4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970d4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970d47f0>]}
[0m00:33:35.992195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:35.993387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:35.997919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76c1ab43-a39a-40d2-9c24-9749b770a9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96eb00d0>]}
[0m00:33:36.036315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76c1ab43-a39a-40d2-9c24-9749b770a9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99091f10>]}
[0m00:33:36.037390 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:36.038320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76c1ab43-a39a-40d2-9c24-9749b770a9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9881fcd0>]}
[0m00:33:36.040009 [info ] [MainThread]: 
[0m00:33:36.041177 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:36.042389 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:33:36.049450 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:33:36.050746 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:33:36.051674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:36.058357 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:33:36.060489 [debug] [ThreadPool]: On list_postgres: Close
[0m00:33:36.062976 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:36.067435 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:36.068510 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:36.069461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:36.074855 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:36.075980 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:36.076999 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:36.080069 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:36.081514 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:36.082608 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:36.084216 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:36.086232 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:36.087482 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:36.088508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:36.093998 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:36.095090 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:36.095947 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:36.098739 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:33:36.101014 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:36.102288 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:36.106955 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:36.108087 [debug] [MainThread]: On master: BEGIN
[0m00:33:36.109037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:36.114446 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:36.115769 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:36.116823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:36.124073 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:33:36.126013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76c1ab43-a39a-40d2-9c24-9749b770a9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c9e520>]}
[0m00:33:36.127308 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:36.128547 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:36.129596 [debug] [MainThread]: On master: BEGIN
[0m00:33:36.130965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:36.132017 [debug] [MainThread]: On master: COMMIT
[0m00:33:36.133032 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:36.134048 [debug] [MainThread]: On master: COMMIT
[0m00:33:36.135174 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:36.136206 [debug] [MainThread]: On master: Close
[0m00:33:36.137428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:36.138476 [info ] [MainThread]: 
[0m00:33:36.149556 [debug] [Thread-1  ]: Began running node model.jaffle_shop.orders
[0m00:33:36.150958 [info ] [Thread-1  ]: 1 of 1 START sql table model public.orders ..................................... [RUN]
[0m00:33:36.152374 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.orders"
[0m00:33:36.153371 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.orders
[0m00:33:36.154390 [debug] [Thread-1  ]: Compiling model.jaffle_shop.orders
[0m00:33:36.158696 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m00:33:36.162401 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:36.163360 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.orders
[0m00:33:36.187186 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m00:33:36.191542 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:33:36.192523 [debug] [Thread-1  ]: On model.jaffle_shop.orders: BEGIN
[0m00:33:36.193606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:36.198869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:36.200100 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:33:36.201008 [debug] [Thread-1  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

  
    

  create  table "postgres"."public"."orders__dbt_tmp"
  as (
    

with orders as (

    select * from "postgres"."public"."stg_orders"

),

payments as (

    select * from "postgres"."public"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
  
[0m00:33:36.206029 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.0 seconds
[0m00:33:36.210818 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:33:36.211836 [debug] [Thread-1  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "postgres"."public"."orders__dbt_tmp" rename to "orders"
[0m00:33:36.213261 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:33:36.225192 [debug] [Thread-1  ]: On model.jaffle_shop.orders: COMMIT
[0m00:33:36.226497 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:33:36.227344 [debug] [Thread-1  ]: On model.jaffle_shop.orders: COMMIT
[0m00:33:36.229249 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:33:36.233020 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:33:36.233911 [debug] [Thread-1  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
drop table if exists "postgres"."public"."orders__dbt_backup" cascade
[0m00:33:36.235024 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m00:33:36.236735 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:36.237733 [debug] [Thread-1  ]: On model.jaffle_shop.orders: Close
[0m00:33:36.239061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c1ab43-a39a-40d2-9c24-9749b770a9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e5ad00>]}
[0m00:33:36.240240 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.orders ................................ [[32mSELECT 99[0m in 0.09s]
[0m00:33:36.241605 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.orders
[0m00:33:36.243495 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:36.244529 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:36.245491 [debug] [MainThread]: On master: BEGIN
[0m00:33:36.246323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:36.251885 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:36.253161 [debug] [MainThread]: On master: COMMIT
[0m00:33:36.254243 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:36.255243 [debug] [MainThread]: On master: COMMIT
[0m00:33:36.256612 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:36.257703 [debug] [MainThread]: On master: Close
[0m00:33:36.259062 [info ] [MainThread]: 
[0m00:33:36.260198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m00:33:36.261229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:36.262149 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m00:33:36.273475 [info ] [MainThread]: 
[0m00:33:36.274599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:36.275702 [info ] [MainThread]: 
[0m00:33:36.276720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:33:36.277779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c0b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97cb32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ed31c0>]}
[0m00:33:36.278838 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:33:37.996778 | 793c02af-1a4a-4f53-8507-37d7ede834db ==============================
[0m00:33:37.996805 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:33:37.997646 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['orders'], 'which': 'test', 'rpc_method': 'test'}
[0m00:33:37.999331 [debug] [MainThread]: Tracking: tracking
[0m00:33:38.004210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f299850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f299760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2997c0>]}
[0m00:33:38.053440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:38.054505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:38.059269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '793c02af-1a4a-4f53-8507-37d7ede834db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0740d0>]}
[0m00:33:38.092874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '793c02af-1a4a-4f53-8507-37d7ede834db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81263d90>]}
[0m00:33:38.094083 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:33:38.095306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793c02af-1a4a-4f53-8507-37d7ede834db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8125cd90>]}
[0m00:33:38.097346 [info ] [MainThread]: 
[0m00:33:38.098594 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:38.100427 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:33:38.107338 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:38.108484 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:33:38.109328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:38.114803 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:33:38.115867 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:33:38.116702 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:33:38.119621 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:33:38.121249 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:33:38.122400 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:33:38.123724 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:33:38.125436 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:38.126321 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:33:38.127124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:38.131801 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.132806 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:33:38.133729 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:33:38.136982 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m00:33:38.139140 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:33:38.140120 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:33:38.143927 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:38.144839 [debug] [MainThread]: On master: BEGIN
[0m00:33:38.145673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:38.150546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.151636 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:38.152461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:38.158121 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:33:38.159747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793c02af-1a4a-4f53-8507-37d7ede834db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f637c0>]}
[0m00:33:38.160874 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:38.161970 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:38.162928 [debug] [MainThread]: On master: BEGIN
[0m00:33:38.164184 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.165002 [debug] [MainThread]: On master: COMMIT
[0m00:33:38.165688 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:38.166391 [debug] [MainThread]: On master: COMMIT
[0m00:33:38.167175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:38.167914 [debug] [MainThread]: On master: Close
[0m00:33:38.168902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:38.169878 [info ] [MainThread]: 
[0m00:33:38.179601 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:33:38.180613 [info ] [Thread-1  ]: 1 of 10 START test accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m00:33:38.181983 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:33:38.182940 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:33:38.183941 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:33:38.192469 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:33:38.198918 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.199789 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:33:38.209191 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:33:38.218463 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:33:38.219377 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: BEGIN
[0m00:33:38.220271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.225300 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:33:38.226166 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:33:38.226899 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."public"."orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m00:33:38.228935 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.231004 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.231927 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: ROLLBACK
[0m00:33:38.232852 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: Close
[0m00:33:38.233946 [info ] [Thread-1  ]: 1 of 10 PASS accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.05s]
[0m00:33:38.235006 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:33:38.235876 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:33:38.236888 [info ] [Thread-1  ]: 2 of 10 START test not_null_orders_amount ...................................... [RUN]
[0m00:33:38.238031 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:33:38.239149 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:33:38.239916 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:33:38.244486 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:33:38.250389 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.251472 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:33:38.253430 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:33:38.256251 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:33:38.257110 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: BEGIN
[0m00:33:38.257927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.262797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.263708 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:33:38.264412 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_amount.106140f9fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "postgres"."public"."orders"
where amount is null



      
    ) dbt_internal_test
[0m00:33:38.266217 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.267714 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.268511 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: ROLLBACK
[0m00:33:38.269601 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: Close
[0m00:33:38.270733 [info ] [Thread-1  ]: 2 of 10 PASS not_null_orders_amount ............................................ [[32mPASS[0m in 0.03s]
[0m00:33:38.271952 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:33:38.272897 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:33:38.273773 [info ] [Thread-1  ]: 3 of 10 START test not_null_orders_bank_transfer_amount ........................ [RUN]
[0m00:33:38.274864 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:33:38.275684 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:33:38.276548 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:33:38.279673 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:33:38.283015 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.283927 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:33:38.285732 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:33:38.288393 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:33:38.289111 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: BEGIN
[0m00:33:38.289686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.294342 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.295270 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:33:38.295958 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select bank_transfer_amount
from "postgres"."public"."orders"
where bank_transfer_amount is null



      
    ) dbt_internal_test
[0m00:33:38.297607 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.299008 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.299722 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: ROLLBACK
[0m00:33:38.300636 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: Close
[0m00:33:38.301723 [info ] [Thread-1  ]: 3 of 10 PASS not_null_orders_bank_transfer_amount .............................. [[32mPASS[0m in 0.03s]
[0m00:33:38.302679 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:33:38.303659 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:33:38.304595 [info ] [Thread-1  ]: 4 of 10 START test not_null_orders_coupon_amount ............................... [RUN]
[0m00:33:38.305884 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:33:38.306765 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:33:38.307542 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:33:38.310903 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:33:38.314913 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.315709 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:33:38.317508 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:33:38.320117 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:33:38.320812 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: BEGIN
[0m00:33:38.321612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.326459 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.327488 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:33:38.328377 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select coupon_amount
from "postgres"."public"."orders"
where coupon_amount is null



      
    ) dbt_internal_test
[0m00:33:38.330201 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.331723 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.332493 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: ROLLBACK
[0m00:33:38.333530 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: Close
[0m00:33:38.334749 [info ] [Thread-1  ]: 4 of 10 PASS not_null_orders_coupon_amount ..................................... [[32mPASS[0m in 0.03s]
[0m00:33:38.335819 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:33:38.336735 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:33:38.337991 [info ] [Thread-1  ]: 5 of 10 START test not_null_orders_credit_card_amount .......................... [RUN]
[0m00:33:38.339185 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:33:38.339988 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:33:38.340753 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:33:38.344087 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:33:38.347620 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.348558 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:33:38.351357 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:33:38.354315 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:33:38.355255 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: BEGIN
[0m00:33:38.355962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.360547 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.361317 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:33:38.362109 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_card_amount
from "postgres"."public"."orders"
where credit_card_amount is null



      
    ) dbt_internal_test
[0m00:33:38.363729 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.365552 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.366396 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: ROLLBACK
[0m00:33:38.367422 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: Close
[0m00:33:38.368524 [info ] [Thread-1  ]: 5 of 10 PASS not_null_orders_credit_card_amount ................................ [[32mPASS[0m in 0.03s]
[0m00:33:38.369664 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:33:38.370540 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:33:38.371438 [info ] [Thread-1  ]: 6 of 10 START test not_null_orders_customer_id ................................. [RUN]
[0m00:33:38.372580 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:33:38.373486 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:33:38.374312 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:33:38.377357 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:33:38.386413 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.387370 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:33:38.389229 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:33:38.399194 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:33:38.400058 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: BEGIN
[0m00:33:38.400745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.405585 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.407627 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:33:38.408474 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."orders"
where customer_id is null



      
    ) dbt_internal_test
[0m00:33:38.410225 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.411646 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.412427 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: ROLLBACK
[0m00:33:38.413355 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: Close
[0m00:33:38.414521 [info ] [Thread-1  ]: 6 of 10 PASS not_null_orders_customer_id ....................................... [[32mPASS[0m in 0.04s]
[0m00:33:38.415773 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:33:38.416674 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:33:38.417511 [info ] [Thread-1  ]: 7 of 10 START test not_null_orders_gift_card_amount ............................ [RUN]
[0m00:33:38.418715 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:33:38.419522 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:33:38.420239 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:33:38.423198 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:33:38.427269 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.428336 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:33:38.430348 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:33:38.434696 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:33:38.435378 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: BEGIN
[0m00:33:38.435951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.440739 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.441750 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:33:38.442438 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gift_card_amount
from "postgres"."public"."orders"
where gift_card_amount is null



      
    ) dbt_internal_test
[0m00:33:38.444050 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.445486 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.446313 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: ROLLBACK
[0m00:33:38.447162 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: Close
[0m00:33:38.448355 [info ] [Thread-1  ]: 7 of 10 PASS not_null_orders_gift_card_amount .................................. [[32mPASS[0m in 0.03s]
[0m00:33:38.449839 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:33:38.450701 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:33:38.451652 [info ] [Thread-1  ]: 8 of 10 START test not_null_orders_order_id .................................... [RUN]
[0m00:33:38.452724 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:33:38.453605 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:33:38.454481 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:33:38.457650 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:33:38.460996 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.461737 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:33:38.463393 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:33:38.466585 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:33:38.467372 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: BEGIN
[0m00:33:38.467946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.472541 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.473539 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:33:38.474341 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m00:33:38.475924 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.477242 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.477899 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: ROLLBACK
[0m00:33:38.478975 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: Close
[0m00:33:38.480200 [info ] [Thread-1  ]: 8 of 10 PASS not_null_orders_order_id .......................................... [[32mPASS[0m in 0.03s]
[0m00:33:38.481367 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:33:38.482315 [debug] [Thread-1  ]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:33:38.483301 [info ] [Thread-1  ]: 9 of 10 START test relationships_orders_customer_id__customer_id__ref_customers_  [RUN]
[0m00:33:38.484452 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:33:38.485464 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:33:38.486344 [debug] [Thread-1  ]: Compiling test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:33:38.491711 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:33:38.497936 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.498889 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:33:38.500957 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:33:38.504161 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:33:38.505045 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: BEGIN
[0m00:33:38.505866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.510738 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.511830 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:33:38.512593 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "postgres"."public"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "postgres"."dbt_dev"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:33:38.514114 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dbt_dev.customers" does not exist
LINE 19:     from "postgres"."dbt_dev"."customers"
                  ^

[0m00:33:38.514908 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: ROLLBACK
[0m00:33:38.515708 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.516505 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
[0m00:33:38.517615 [debug] [Thread-1  ]: Database Error in test relationships_orders_customer_id__customer_id__ref_customers_ (models/schema.yml)
  relation "dbt_dev.customers" does not exist
  LINE 19:     from "postgres"."dbt_dev"."customers"
                    ^
  compiled Code at target/run/jaffle_shop/models/schema.yml/relationships_orders_customer_id__customer_id__ref_customers_.sql
[0m00:33:38.518547 [error] [Thread-1  ]: 9 of 10 ERROR relationships_orders_customer_id__customer_id__ref_customers_ .... [[31mERROR[0m in 0.03s]
[0m00:33:38.519853 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:33:38.520806 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:33:38.521714 [info ] [Thread-1  ]: 10 of 10 START test unique_orders_order_id ..................................... [RUN]
[0m00:33:38.522885 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:33:38.523652 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:33:38.524461 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:33:38.529454 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:33:38.532740 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.533443 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:33:38.535158 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:33:38.539942 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:33:38.540785 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: BEGIN
[0m00:33:38.541457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:38.546445 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:33:38.547305 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:33:38.547902 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:33:38.549564 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:38.551030 [debug] [Thread-1  ]: finished collecting timing info
[0m00:33:38.551912 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: ROLLBACK
[0m00:33:38.552909 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: Close
[0m00:33:38.554122 [info ] [Thread-1  ]: 10 of 10 PASS unique_orders_order_id ........................................... [[32mPASS[0m in 0.03s]
[0m00:33:38.555229 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:33:38.557011 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:33:38.557971 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:38.558797 [debug] [MainThread]: On master: BEGIN
[0m00:33:38.559650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:38.565083 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:33:38.566121 [debug] [MainThread]: On master: COMMIT
[0m00:33:38.566940 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:38.567717 [debug] [MainThread]: On master: COMMIT
[0m00:33:38.568568 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:38.569296 [debug] [MainThread]: On master: Close
[0m00:33:38.570349 [info ] [MainThread]: 
[0m00:33:38.571427 [info ] [MainThread]: Finished running 10 tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:33:38.572325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:38.573110 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e' was properly closed.
[0m00:33:38.588614 [info ] [MainThread]: 
[0m00:33:38.589364 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:33:38.589989 [info ] [MainThread]: 
[0m00:33:38.590606 [error] [MainThread]: [33mDatabase Error in test relationships_orders_customer_id__customer_id__ref_customers_ (models/schema.yml)[0m
[0m00:33:38.591243 [error] [MainThread]:   relation "dbt_dev.customers" does not exist
[0m00:33:38.591862 [error] [MainThread]:   LINE 19:     from "postgres"."dbt_dev"."customers"
[0m00:33:38.592493 [error] [MainThread]:                     ^
[0m00:33:38.593133 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/schema.yml/relationships_orders_customer_id__customer_id__ref_customers_.sql
[0m00:33:38.593768 [info ] [MainThread]: 
[0m00:33:38.594408 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m00:33:38.595129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e776e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e776f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf60c40>]}
[0m00:33:38.595813 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:34:08.720229 | 61aa13a7-f671-4a1a-be25-85d7cb9d673b ==============================
[0m00:34:08.720269 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:34:08.722421 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_payments"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:34:08.723306 [debug] [MainThread]: Tracking: tracking
[0m00:34:08.741743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952f2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952f2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952f27c0>]}
[0m00:34:08.807895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:08.821185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:08.826983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61aa13a7-f671-4a1a-be25-85d7cb9d673b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950cd0d0>]}
[0m00:34:08.919926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61aa13a7-f671-4a1a-be25-85d7cb9d673b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a3dcd0>]}
[0m00:34:08.921122 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:34:08.921785 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:08.922558 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:34:08.923087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:08.929909 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:34:08.931021 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:34:08.931742 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:08.932293 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:34:08.933032 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:34:08.940928 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:08.941896 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_payments
  
[0m00:34:08.944234 [debug] [MainThread]: Postgres adapter: Postgres error: cannot drop table raw_payments because other objects depend on it
DETAIL:  view stg_payments depends on table raw_payments
HINT:  Use DROP ... CASCADE to drop the dependent objects too.

[0m00:34:08.945381 [debug] [MainThread]: Postgres adapter: Error running SQL: macro drop_table
[0m00:34:08.947303 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m00:34:08.949587 [debug] [MainThread]: On macro_drop_table: Close
[0m00:34:08.954321 [error] [MainThread]: Encountered an error while running operation: Database Error
  cannot drop table raw_payments because other objects depend on it
  DETAIL:  view stg_payments depends on table raw_payments
  HINT:  Use DROP ... CASCADE to drop the dependent objects too.
[0m00:34:08.955653 [debug] [MainThread]: 
[0m00:34:08.957013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950e2ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950e2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950e2f70>]}
[0m00:34:08.958119 [debug] [MainThread]: Flushing usage events
[0m00:34:09.084066 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.


============================== 2023-01-04 00:34:09.293835 | deb74c25-b08b-4d2e-ae20-6f11136c4f1d ==============================
[0m00:34:09.293884 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:34:09.295924 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_orders"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:34:09.296943 [debug] [MainThread]: Tracking: tracking
[0m00:34:09.312365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa218f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa218f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa218f790>]}


============================== 2023-01-04 00:34:09.369639 | 15939721-2e9d-4aba-9556-18225b1c931b ==============================
[0m00:34:09.369673 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:34:09.370526 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_customers"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:34:09.371251 [debug] [MainThread]: Tracking: tracking
[0m00:34:09.377971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b7c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b7c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b7c790>]}
[0m00:34:09.399161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:09.402310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:09.411328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deb74c25-b08b-4d2e-ae20-6f11136c4f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f6b0d0>]}
[0m00:34:09.456731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb74c25-b08b-4d2e-ae20-6f11136c4f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41506a0>]}
[0m00:34:09.458469 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:34:09.460628 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:09.464047 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:34:09.464886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:09.465297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:09.466349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:09.473214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15939721-2e9d-4aba-9556-18225b1c931b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39570d0>]}
[0m00:34:09.475203 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:34:09.476658 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:34:09.478427 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:09.479522 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:34:09.480842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:34:09.491757 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:09.493226 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_orders
  
[0m00:34:09.495963 [debug] [MainThread]: Postgres adapter: Postgres error: cannot drop table raw_orders because other objects depend on it
DETAIL:  view stg_orders depends on table raw_orders
HINT:  Use DROP ... CASCADE to drop the dependent objects too.

[0m00:34:09.497282 [debug] [MainThread]: Postgres adapter: Error running SQL: macro drop_table
[0m00:34:09.498210 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m00:34:09.499131 [debug] [MainThread]: On macro_drop_table: Close
[0m00:34:09.500711 [error] [MainThread]: Encountered an error while running operation: Database Error
  cannot drop table raw_orders because other objects depend on it
  DETAIL:  view stg_orders depends on table raw_orders
  HINT:  Use DROP ... CASCADE to drop the dependent objects too.
[0m00:34:09.505113 [debug] [MainThread]: 
[0m00:34:09.506266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa218f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f80f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f80f70>]}
[0m00:34:09.507480 [debug] [MainThread]: Flushing usage events
[0m00:34:09.514343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15939721-2e9d-4aba-9556-18225b1c931b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b49c40>]}
[0m00:34:09.515802 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:34:09.516842 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:09.517670 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:34:09.518497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:09.525683 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:34:09.526932 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:34:09.527807 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:09.528689 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:34:09.529607 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:34:09.536577 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:34:09.537724 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_customers
  
[0m00:34:09.539669 [debug] [MainThread]: Postgres adapter: Postgres error: cannot drop table raw_customers because other objects depend on it
DETAIL:  view stg_customers depends on table raw_customers
HINT:  Use DROP ... CASCADE to drop the dependent objects too.

[0m00:34:09.540651 [debug] [MainThread]: Postgres adapter: Error running SQL: macro drop_table
[0m00:34:09.541302 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m00:34:09.542083 [debug] [MainThread]: On macro_drop_table: Close
[0m00:34:09.543251 [error] [MainThread]: Encountered an error while running operation: Database Error
  cannot drop table raw_customers because other objects depend on it
  DETAIL:  view stg_customers depends on table raw_customers
  HINT:  Use DROP ... CASCADE to drop the dependent objects too.
[0m00:34:09.545337 [debug] [MainThread]: 
[0m00:34:09.546434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b7c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb396cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb396c850>]}
[0m00:34:09.547322 [debug] [MainThread]: Flushing usage events
[0m00:34:09.588738 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.
[0m00:34:09.661223 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.


============================== 2023-01-04 00:37:44.849992 | 0a05fd44-d8f4-469a-b600-cc6ace853c86 ==============================
[0m00:37:44.850085 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:37:44.851805 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_customers"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:37:44.853742 [debug] [MainThread]: Tracking: tracking
[0m00:37:44.871712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0e5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0e5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0e5790>]}
[0m00:37:44.983126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:44.984409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:44.998066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a05fd44-d8f4-469a-b600-cc6ace853c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f3c0d0>]}
[0m00:37:45.104049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a05fd44-d8f4-469a-b600-cc6ace853c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad7dfd0>]}
[0m00:37:45.105450 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:37:45.106373 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:37:45.112067 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:37:45.112839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:45.121662 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:37:45.122561 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:37:45.123401 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:37:45.124231 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:37:45.125345 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:37:45.132862 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:37:45.139536 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_customers
  
[0m00:37:45.141259 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:37:45.144691 [debug] [MainThread]: On macro_drop_table: Close
[0m00:37:45.150186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0e5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f54f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f54e80>]}
[0m00:37:45.152028 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:37:45.162066 | fb0edaf2-0e37-4eb7-9ace-2b31aefcf270 ==============================
[0m00:37:45.162122 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:37:45.164517 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_payments"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:37:45.167128 [debug] [MainThread]: Tracking: tracking
[0m00:37:45.186246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef44820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef44730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef44790>]}
[0m00:37:45.236846 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.
[0m00:37:45.306786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:45.307849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:45.314769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb0edaf2-0e37-4eb7-9ace-2b31aefcf270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed1f0d0>]}
[0m00:37:45.392200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb0edaf2-0e37-4eb7-9ace-2b31aefcf270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f046a0>]}
[0m00:37:45.394786 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:37:45.395989 [debug] [MainThread]: Using postgres connection "macro_drop_table"


============================== 2023-01-04 00:37:45.396697 | 1bc2b67f-4720-4540-b1ac-12455106ff67 ==============================
[0m00:37:45.396734 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:37:45.398432 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_orders"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:37:45.397258 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:37:45.399682 [debug] [MainThread]: Tracking: tracking
[0m00:37:45.402233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:45.412255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92427820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92427730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92427790>]}
[0m00:37:45.413869 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:37:45.414623 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:37:45.415134 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:37:45.415794 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:37:45.417702 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:37:45.433925 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:37:45.439466 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_payments
  
[0m00:37:45.445927 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:37:45.450943 [debug] [MainThread]: On macro_drop_table: Close
[0m00:37:45.455625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef44820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed35df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed35eb0>]}
[0m00:37:45.462283 [debug] [MainThread]: Flushing usage events
[0m00:37:45.545063 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.
[0m00:37:45.567935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:45.569674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:45.575698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bc2b67f-4720-4540-b1ac-12455106ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922020d0>]}
[0m00:37:45.651498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bc2b67f-4720-4540-b1ac-12455106ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943e8370>]}
[0m00:37:45.653196 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:37:45.654605 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:37:45.656680 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:37:45.660578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:45.669272 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:37:45.671157 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:37:45.672554 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:37:45.673604 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:37:45.674901 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:37:45.683984 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:37:45.685654 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_orders
  
[0m00:37:45.687333 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:37:45.690196 [debug] [MainThread]: On macro_drop_table: Close
[0m00:37:45.692288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92427820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92218eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92218f10>]}
[0m00:37:45.693588 [debug] [MainThread]: Flushing usage events
[0m00:37:45.770819 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.


============================== 2023-01-04 00:38:05.605927 | 0b494d77-6b0b-4ad4-858b-cd3b785c182a ==============================
[0m00:38:05.605956 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:05.609140 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m00:38:05.611089 [debug] [MainThread]: Tracking: tracking
[0m00:38:05.626464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8cdb8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8cdb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8cdb850>]}
[0m00:38:05.719903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:05.721590 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:05.727248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b494d77-6b0b-4ad4-858b-cd3b785c182a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ab70d0>]}
[0m00:38:05.770834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b494d77-6b0b-4ad4-858b-cd3b785c182a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa41b790>]}
[0m00:38:05.771909 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:05.773914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b494d77-6b0b-4ad4-858b-cd3b785c182a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac9ec40>]}
[0m00:38:05.778896 [info ] [MainThread]: 
[0m00:38:05.780372 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:05.782925 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:38:05.791256 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:38:05.792956 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:38:05.794079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:05.802349 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:38:05.804794 [debug] [ThreadPool]: On list_postgres: Close
[0m00:38:05.807571 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:05.822237 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:05.824463 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:05.825332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:05.830729 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:05.831534 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:05.832543 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:05.835501 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m00:38:05.837987 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:05.841952 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:05.845588 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:05.848573 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:05.849589 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:05.851165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:05.857023 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:05.857843 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:05.858606 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:05.861674 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:05.864261 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:05.865472 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:05.870236 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:05.871622 [debug] [MainThread]: On master: BEGIN
[0m00:38:05.872811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:05.881492 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:05.882703 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:05.884182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:05.898883 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m00:38:05.900519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b494d77-6b0b-4ad4-858b-cd3b785c182a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa983bd90>]}
[0m00:38:05.902015 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:05.903065 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:05.904036 [debug] [MainThread]: On master: BEGIN
[0m00:38:05.905270 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:05.906277 [debug] [MainThread]: On master: COMMIT
[0m00:38:05.907163 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:05.909134 [debug] [MainThread]: On master: COMMIT
[0m00:38:05.910275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:05.911124 [debug] [MainThread]: On master: Close
[0m00:38:05.912462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:05.913576 [info ] [MainThread]: 
[0m00:38:05.924372 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_customers
[0m00:38:05.925688 [info ] [Thread-1  ]: 1 of 3 START seed file public.raw_customers .................................... [RUN]
[0m00:38:05.927316 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:05.928355 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_customers
[0m00:38:05.929295 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:05.930245 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_customers
[0m00:38:05.960578 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:05.961657 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: BEGIN
[0m00:38:05.963054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:05.971701 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:05.972949 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:05.974024 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "postgres"."public"."raw_customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m00:38:05.978038 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:38:06.026079 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:06.027046 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: 
          insert into "postgres"."public"."raw_customers" ("id", "first_name", "last_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m00:38:06.028941 [debug] [Thread-1  ]: SQL status: INSERT 0 100 in 0.0 seconds
[0m00:38:06.033532 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m00:38:06.049132 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: COMMIT
[0m00:38:06.050181 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:06.051103 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: COMMIT
[0m00:38:06.054764 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:38:06.055866 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:06.056597 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: Close
[0m00:38:06.057837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b494d77-6b0b-4ad4-858b-cd3b785c182a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a4f490>]}
[0m00:38:06.058860 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file public.raw_customers ................................ [[32mINSERT 100[0m in 0.13s]
[0m00:38:06.060241 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_customers
[0m00:38:06.062762 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_orders
[0m00:38:06.064127 [info ] [Thread-1  ]: 2 of 3 START seed file public.raw_orders ....................................... [RUN]
[0m00:38:06.065399 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:06.066817 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_orders
[0m00:38:06.068136 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:06.069122 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_orders
[0m00:38:06.076478 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:06.078160 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: BEGIN
[0m00:38:06.079799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:06.087379 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:06.089431 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:06.092274 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "postgres"."public"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m00:38:06.097314 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:38:06.137509 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:06.138811 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: 
          insert into "postgres"."public"."raw_orders" ("id", "user_id", "order_date", "status") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m00:38:06.141064 [debug] [Thread-1  ]: SQL status: INSERT 0 99 in 0.0 seconds
[0m00:38:06.142240 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m00:38:06.148909 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: COMMIT
[0m00:38:06.149827 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:06.152825 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: COMMIT
[0m00:38:06.154417 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:38:06.155593 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:06.156677 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: Close
[0m00:38:06.158092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b494d77-6b0b-4ad4-858b-cd3b785c182a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a55b20>]}
[0m00:38:06.159230 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file public.raw_orders ................................... [[32mINSERT 99[0m in 0.09s]
[0m00:38:06.160683 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_orders
[0m00:38:06.161647 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_payments
[0m00:38:06.162653 [info ] [Thread-1  ]: 3 of 3 START seed file public.raw_payments ..................................... [RUN]
[0m00:38:06.163899 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:06.164857 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_payments
[0m00:38:06.166246 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:06.166994 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_payments
[0m00:38:06.173136 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:06.174089 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: BEGIN
[0m00:38:06.175450 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:06.181775 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:06.182553 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:06.183280 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "postgres"."public"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer)
  
[0m00:38:06.186320 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:38:06.247166 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:06.248641 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: 
          insert into "postgres"."public"."raw_payments" ("id", "order_id", "payment_method", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m00:38:06.250737 [debug] [Thread-1  ]: SQL status: INSERT 0 113 in 0.0 seconds
[0m00:38:06.254923 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m00:38:06.260809 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: COMMIT
[0m00:38:06.262422 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:06.263684 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: COMMIT
[0m00:38:06.266160 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:38:06.267625 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:06.268737 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: Close
[0m00:38:06.270236 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b494d77-6b0b-4ad4-858b-cd3b785c182a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81ddbb0>]}
[0m00:38:06.271319 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file public.raw_payments ................................. [[32mINSERT 113[0m in 0.11s]
[0m00:38:06.272272 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_payments
[0m00:38:06.273973 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:06.275047 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:06.275952 [debug] [MainThread]: On master: BEGIN
[0m00:38:06.276871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:06.282180 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:06.283102 [debug] [MainThread]: On master: COMMIT
[0m00:38:06.283904 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:06.284766 [debug] [MainThread]: On master: COMMIT
[0m00:38:06.285765 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:06.286659 [debug] [MainThread]: On master: Close
[0m00:38:06.287839 [info ] [MainThread]: 
[0m00:38:06.288946 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m00:38:06.289896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:06.290731 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m00:38:06.302824 [info ] [MainThread]: 
[0m00:38:06.303932 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:06.304802 [info ] [MainThread]: 
[0m00:38:06.305766 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:38:06.306857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa983b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9812490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a4c250>]}
[0m00:38:06.308198 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:38:09.716620 | e77dc7b0-deb1-47e4-ac2f-1a64c14bf815 ==============================
[0m00:38:09.716671 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:09.717995 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_customers"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:38:09.719224 [debug] [MainThread]: Tracking: tracking
[0m00:38:09.742283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ec3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ec3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ec3790>]}
[0m00:38:09.810373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:09.811686 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:09.820016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77dc7b0-deb1-47e4-ac2f-1a64c14bf815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c9e0d0>]}
[0m00:38:09.865784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77dc7b0-deb1-47e4-ac2f-1a64c14bf815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e86d90>]}
[0m00:38:09.867583 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:38:09.868387 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:09.869590 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:38:09.870582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:09.877186 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:09.878183 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:38:09.879240 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:09.880043 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:38:09.880938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:09.890101 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:09.891342 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_customers
  
[0m00:38:09.895540 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:38:09.897474 [debug] [MainThread]: On macro_drop_table: Close
[0m00:38:09.899273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ec3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cb4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cb4f70>]}
[0m00:38:09.900521 [debug] [MainThread]: Flushing usage events
[0m00:38:09.987716 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.


============================== 2023-01-04 00:38:10.248337 | 4b2059fb-2ce1-4a86-a279-8b42ecabbcdc ==============================
[0m00:38:10.248385 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:10.250039 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_payments"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:38:10.251060 [debug] [MainThread]: Tracking: tracking
[0m00:38:10.286312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaffe1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaffe1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaffe1790>]}
[0m00:38:10.387421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:10.388892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:10.398971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b2059fb-2ce1-4a86-a279-8b42ecabbcdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdbd0d0>]}


============================== 2023-01-04 00:38:10.419381 | 1e8b8760-89eb-4823-8403-13625cb17617 ==============================
[0m00:38:10.419409 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:10.421511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'macro': 'drop_table', 'args': '{"table_name": "raw_orders"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m00:38:10.427211 [debug] [MainThread]: Tracking: tracking
[0m00:38:10.435352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07ee820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07ee730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07ee790>]}
[0m00:38:10.484093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b2059fb-2ce1-4a86-a279-8b42ecabbcdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1fa24f0>]}
[0m00:38:10.486840 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:38:10.489852 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:10.492806 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:38:10.494128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:10.502772 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:10.503843 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:38:10.504775 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:10.505556 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:38:10.506620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:10.511223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:10.512913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:10.514717 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:10.516130 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_payments
  
[0m00:38:10.518944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e8b8760-89eb-4823-8403-13625cb17617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05c90d0>]}
[0m00:38:10.521988 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:38:10.526427 [debug] [MainThread]: On macro_drop_table: Close
[0m00:38:10.528857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdd1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdd1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdd1820>]}
[0m00:38:10.530295 [debug] [MainThread]: Flushing usage events
[0m00:38:10.565596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8b8760-89eb-4823-8403-13625cb17617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27a13d0>]}
[0m00:38:10.567165 [debug] [MainThread]: Acquiring new postgres connection "macro_drop_table"
[0m00:38:10.568218 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:10.569410 [debug] [MainThread]: On macro_drop_table: BEGIN
[0m00:38:10.571207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:10.577511 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:10.578416 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:38:10.579181 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:10.580195 [debug] [MainThread]: On macro_drop_table: COMMIT
[0m00:38:10.581231 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:10.588535 [debug] [MainThread]: Using postgres connection "macro_drop_table"
[0m00:38:10.590213 [debug] [MainThread]: On macro_drop_table: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "macro_drop_table"} */

    DROP TABLE IF EXISTS public.raw_orders
  
[0m00:38:10.593777 [debug] [MainThread]: SQL status: DROP TABLE in 0.0 seconds
[0m00:38:10.595712 [debug] [MainThread]: On macro_drop_table: Close
[0m00:38:10.597223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07ee820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05dfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05dfe50>]}
[0m00:38:10.598338 [debug] [MainThread]: Flushing usage events
[0m00:38:10.610529 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.
[0m00:38:10.677583 [debug] [MainThread]: Connection 'macro_drop_table' was properly closed.


============================== 2023-01-04 00:38:13.464080 | b51acec3-afdc-467f-949a-0d79e2631ff6 ==============================
[0m00:38:13.464151 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:13.467115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m00:38:13.474589 [debug] [MainThread]: Tracking: tracking
[0m00:38:13.487231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92297850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92297760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922977c0>]}
[0m00:38:13.623684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:13.630409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:13.656410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b51acec3-afdc-467f-949a-0d79e2631ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920730d0>]}
[0m00:38:13.812072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b51acec3-afdc-467f-949a-0d79e2631ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939aefd0>]}
[0m00:38:13.823257 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:13.831134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b51acec3-afdc-467f-949a-0d79e2631ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e844c0>]}
[0m00:38:13.849729 [info ] [MainThread]: 
[0m00:38:13.858934 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:13.863622 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:38:13.876842 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:38:13.878919 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:38:13.880906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:13.894528 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:38:13.897712 [debug] [ThreadPool]: On list_postgres: Close
[0m00:38:13.904818 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:13.912465 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:13.915035 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:13.916642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:13.925307 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:13.930208 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:13.937357 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:13.946814 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m00:38:13.950547 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:13.956353 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:13.969039 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:13.974636 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:13.978535 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:13.981107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:13.999280 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m00:38:14.003948 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:14.014085 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:14.025678 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m00:38:14.031690 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:14.040345 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:14.053878 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:14.057219 [debug] [MainThread]: On master: BEGIN
[0m00:38:14.058945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:14.086945 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m00:38:14.089654 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:14.096760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:14.103083 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:14.108032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b51acec3-afdc-467f-949a-0d79e2631ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e133d0>]}
[0m00:38:14.109695 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:14.111720 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:14.114666 [debug] [MainThread]: On master: BEGIN
[0m00:38:14.117095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:14.118671 [debug] [MainThread]: On master: COMMIT
[0m00:38:14.121360 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:14.122390 [debug] [MainThread]: On master: COMMIT
[0m00:38:14.123675 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:14.125031 [debug] [MainThread]: On master: Close
[0m00:38:14.126383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:14.128212 [info ] [MainThread]: 
[0m00:38:14.142141 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_customers
[0m00:38:14.143440 [info ] [Thread-1  ]: 1 of 3 START seed file public.raw_customers .................................... [RUN]
[0m00:38:14.166162 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:14.200639 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_customers
[0m00:38:14.202636 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:14.236671 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_customers
[0m00:38:14.263373 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:14.265464 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: BEGIN
[0m00:38:14.266521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:14.273715 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:14.277091 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:14.279884 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "postgres"."public"."raw_customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m00:38:14.285760 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:38:14.324668 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:14.325632 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: 
          insert into "postgres"."public"."raw_customers" ("id", "first_name", "last_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s...
[0m00:38:14.327527 [debug] [Thread-1  ]: SQL status: INSERT 0 100 in 0.0 seconds
[0m00:38:14.333225 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m00:38:14.354464 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: COMMIT
[0m00:38:14.357508 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m00:38:14.358856 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: COMMIT
[0m00:38:14.360493 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:38:14.361793 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:14.362921 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: Close
[0m00:38:14.367380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b51acec3-afdc-467f-949a-0d79e2631ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fce910>]}
[0m00:38:14.369736 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file public.raw_customers ................................ [[32mINSERT 100[0m in 0.20s]
[0m00:38:14.371451 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_customers
[0m00:38:14.372585 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_orders
[0m00:38:14.373590 [info ] [Thread-1  ]: 2 of 3 START seed file public.raw_orders ....................................... [RUN]
[0m00:38:14.375586 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:14.376861 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_orders
[0m00:38:14.378532 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:14.379781 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_orders
[0m00:38:14.387980 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:14.389402 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: BEGIN
[0m00:38:14.390538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:14.396209 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:14.398026 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:14.399089 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "postgres"."public"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m00:38:14.402725 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:38:14.440436 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:14.441654 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: 
          insert into "postgres"."public"."raw_orders" ("id", "user_id", "order_date", "status") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m00:38:14.444185 [debug] [Thread-1  ]: SQL status: INSERT 0 99 in 0.0 seconds
[0m00:38:14.445650 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m00:38:14.452120 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: COMMIT
[0m00:38:14.453280 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m00:38:14.454568 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: COMMIT
[0m00:38:14.456829 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:38:14.458575 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:14.462334 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_orders: Close
[0m00:38:14.463803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b51acec3-afdc-467f-949a-0d79e2631ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92000d30>]}
[0m00:38:14.465900 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file public.raw_orders ................................... [[32mINSERT 99[0m in 0.09s]
[0m00:38:14.467121 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_orders
[0m00:38:14.468566 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_payments
[0m00:38:14.469905 [info ] [Thread-1  ]: 3 of 3 START seed file public.raw_payments ..................................... [RUN]
[0m00:38:14.471617 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:14.473100 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_payments
[0m00:38:14.474366 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:14.475423 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_payments
[0m00:38:14.481980 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:14.483639 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: BEGIN
[0m00:38:14.484936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:14.491355 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:14.493265 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:14.494442 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "postgres"."public"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer)
  
[0m00:38:14.500069 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:38:14.543333 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:14.545045 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: 
          insert into "postgres"."public"."raw_payments" ("id", "order_id", "payment_method", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m00:38:14.547491 [debug] [Thread-1  ]: SQL status: INSERT 0 113 in 0.0 seconds
[0m00:38:14.549254 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m00:38:14.553618 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: COMMIT
[0m00:38:14.554724 [debug] [Thread-1  ]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m00:38:14.555710 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: COMMIT
[0m00:38:14.568030 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
[0m00:38:14.569804 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:14.571172 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_payments: Close
[0m00:38:14.573082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b51acec3-afdc-467f-949a-0d79e2631ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91799b80>]}
[0m00:38:14.574867 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file public.raw_payments ................................. [[32mINSERT 113[0m in 0.10s]
[0m00:38:14.576761 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_payments
[0m00:38:14.578997 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:14.580829 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:14.582136 [debug] [MainThread]: On master: BEGIN
[0m00:38:14.583628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:14.590257 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:14.592099 [debug] [MainThread]: On master: COMMIT
[0m00:38:14.593222 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:14.596350 [debug] [MainThread]: On master: COMMIT
[0m00:38:14.598136 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:14.599884 [debug] [MainThread]: On master: Close
[0m00:38:14.601620 [info ] [MainThread]: 
[0m00:38:14.602933 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m00:38:14.604328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:14.605349 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m00:38:14.623711 [info ] [MainThread]: 
[0m00:38:14.625309 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:14.628175 [info ] [MainThread]: 
[0m00:38:14.629639 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:38:14.631596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91791fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e04670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9202faf0>]}
[0m00:38:14.636447 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:38:34.116782 | 03cb00ec-9afc-4592-a05c-fdc0cfc2b3db ==============================
[0m00:38:34.116858 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:34.119653 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:38:34.120870 [debug] [MainThread]: Tracking: tracking
[0m00:38:34.137206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1cf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1cf760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1cf7c0>]}
[0m00:38:34.201565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:34.202551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:34.207019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03cb00ec-9afc-4592-a05c-fdc0cfc2b3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cfac0d0>]}


============================== 2023-01-04 00:38:34.235786 | 99f9640d-e02f-4495-8220-d15ce593feec ==============================
[0m00:38:34.235858 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:34.239736 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:38:34.243109 [debug] [MainThread]: Tracking: tracking
[0m00:38:34.247285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03cb00ec-9afc-4592-a05c-fdc0cfc2b3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddacf40>]}
[0m00:38:34.248310 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:34.249374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb00ec-9afc-4592-a05c-fdc0cfc2b3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1843d0>]}
[0m00:38:34.250899 [info ] [MainThread]: 
[0m00:38:34.252053 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:34.260221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b116850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b116760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1167c0>]}
[0m00:38:34.266330 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:38:34.274035 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:38:34.274922 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:38:34.275989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:34.284330 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:38:34.286103 [debug] [ThreadPool]: On list_postgres: Close
[0m00:38:34.293418 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:34.301735 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.302986 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:34.303903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.309054 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.310072 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.311533 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:34.315180 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:34.316926 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:34.317873 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:34.321867 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:34.324004 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.324731 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:34.325500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.330443 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:38:34.331264 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.332041 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:34.335204 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m00:38:34.337445 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:34.345523 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:34.345643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:34.347257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:34.351815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99f9640d-e02f-4495-8220-d15ce593feec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aef20d0>]}
[0m00:38:34.352775 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.353778 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.354566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:34.359937 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.360879 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.361762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:34.365821 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:34.367668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb00ec-9afc-4592-a05c-fdc0cfc2b3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd4bc40>]}
[0m00:38:34.368775 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:34.369663 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.370338 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.371241 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:34.372030 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.372658 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.373226 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.373995 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.374617 [debug] [MainThread]: On master: Close
[0m00:38:34.375769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:34.376453 [info ] [MainThread]: 


============================== 2023-01-04 00:38:34.386732 | bc482a4c-33c4-4d8b-97af-69d5d65e0b2e ==============================
[0m00:38:34.386797 [info ] [MainThread]: Running with dbt=1.3.1


============================== 2023-01-04 00:38:34.387941 | 3ee108e3-152a-47cc-bdb9-4e4349c55e80 ==============================
[0m00:38:34.388052 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:34.388749 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_payments'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:38:34.390336 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:38:34.390390 [debug] [MainThread]: Tracking: tracking
[0m00:38:34.391630 [debug] [MainThread]: Tracking: tracking
[0m00:38:34.399079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f98850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f98760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f987c0>]}
[0m00:38:34.400029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99f9640d-e02f-4495-8220-d15ce593feec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0e0d90>]}
[0m00:38:34.401579 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:34.402617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f9640d-e02f-4495-8220-d15ce593feec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0d9d90>]}
[0m00:38:34.404441 [info ] [MainThread]: 
[0m00:38:34.405825 [debug] [MainThread]: Acquiring new postgres connection "master"


============================== 2023-01-04 00:38:34.406787 | 8e198feb-5c75-4d49-8861-ceea87f2c56c ==============================
[0m00:38:34.406819 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:34.408124 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:38:34.407309 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:38:34.409039 [debug] [MainThread]: Tracking: tracking
[0m00:38:34.409341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28218b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28217c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2821820>]}
[0m00:38:34.414362 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_orders
[0m00:38:34.415372 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_orders .................................. [RUN]
[0m00:38:34.416465 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.415863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5a1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5a1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5a17c0>]}
[0m00:38:34.416938 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_orders
[0m00:38:34.418573 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_orders
[0m00:38:34.423749 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m00:38:34.422019 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:38:34.426025 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:38:34.428020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:34.428276 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:34.430752 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_orders
[0m00:38:34.435297 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:38:34.436983 [debug] [ThreadPool]: On list_postgres: Close
[0m00:38:34.439459 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:34.448738 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.449925 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:34.451032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.456237 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.457172 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.457833 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:34.461031 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m00:38:34.462879 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:34.464025 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:34.465346 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:34.468125 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.469233 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:34.470101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.477094 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.483413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:34.485025 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.484853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:34.486067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:34.487241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:34.486890 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:34.491028 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:34.492044 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m00:38:34.492469 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:34.493778 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:34.495664 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.496471 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m00:38:34.497107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:34.498584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc482a4c-33c4-4d8b-97af-69d5d65e0b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25fd0d0>]}
[0m00:38:34.499218 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.500204 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.500795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:34.503148 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.504149 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.505082 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "postgres"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m00:38:34.508077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ee108e3-152a-47cc-bdb9-4e4349c55e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d740d0>]}
[0m00:38:34.508846 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:38:34.516432 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m00:38:34.516846 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.518213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:34.519004 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.520804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:34.520032 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:38:34.521200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:34.525815 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:38:34.529555 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:34.529845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e198feb-5c75-4d49-8861-ceea87f2c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c37c0d0>]}
[0m00:38:34.531436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f9640d-e02f-4495-8220-d15ce593feec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc83700>]}
[0m00:38:34.532412 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:34.533511 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.534576 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.535815 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:34.536618 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.537426 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.538296 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.539209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.539296 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m00:38:34.540244 [debug] [MainThread]: On master: Close
[0m00:38:34.541270 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.542000 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m00:38:34.542098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:34.543762 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.543685 [info ] [MainThread]: 
[0m00:38:34.548759 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.555314 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "postgres"."public"."stg_orders__dbt_backup" cascade
[0m00:38:34.558076 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:38:34.559336 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_orders
[0m00:38:34.561519 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_orders .................................. [RUN]
[0m00:38:34.561488 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:34.562705 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.562745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ee108e3-152a-47cc-bdb9-4e4349c55e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb6d8790>]}
[0m00:38:34.563464 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: Close
[0m00:38:34.564299 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_orders
[0m00:38:34.564834 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:34.566703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc482a4c-33c4-4d8b-97af-69d5d65e0b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f722b0>]}
[0m00:38:34.567748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb00ec-9afc-4592-a05c-fdc0cfc2b3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d01ebe0>]}
[0m00:38:34.568634 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_orders
[0m00:38:34.569237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ee108e3-152a-47cc-bdb9-4e4349c55e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbf594f0>]}
[0m00:38:34.570173 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:34.572651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc482a4c-33c4-4d8b-97af-69d5d65e0b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47ebc10>]}
[0m00:38:34.573351 [info ] [MainThread]: 
[0m00:38:34.573678 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m00:38:34.570856 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m00:38:34.574804 [info ] [MainThread]: 
[0m00:38:34.576836 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:34.577950 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_orders
[0m00:38:34.580115 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:38:34.598789 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:34.578975 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:34.617580 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_orders
[0m00:38:34.598361 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:34.619137 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:38:34.599257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e198feb-5c75-4d49-8861-ceea87f2c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d17ef40>]}
[0m00:38:34.604929 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:38:34.637793 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.639271 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics


============================== 2023-01-04 00:38:34.638737 | 4e23a2d4-18ce-466a-9434-6e52e77493d0 ==============================
[0m00:38:34.638763 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:34.640222 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m00:38:34.639558 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:38:34.657110 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.645644 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:38:34.658816 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_payments'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:38:34.658065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e198feb-5c75-4d49-8861-ceea87f2c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5523d0>]}
[0m00:38:34.659788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:34.663354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:34.663654 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:38:34.664782 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.665136 [debug] [MainThread]: Tracking: tracking
[0m00:38:34.666835 [info ] [MainThread]: 
[0m00:38:34.672465 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.669156 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m00:38:34.668682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:34.674349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:34.673618 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.674034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c83d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c83d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c83d7c0>]}
[0m00:38:34.673139 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:34.674130 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:38:34.677091 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.679284 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:38:34.680798 [debug] [ThreadPool]: On list_postgres: Close
[0m00:38:34.680158 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.680838 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:38:34.682716 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:34.687201 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:38:34.685844 [debug] [ThreadPool]: On list_postgres: Close
[0m00:38:34.683423 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.684518 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.687866 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:38:34.690596 [debug] [MainThread]: On master: Close
[0m00:38:34.692917 [info ] [MainThread]: 
[0m00:38:34.689770 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:34.690398 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.690043 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.691712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:34.694206 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m00:38:34.698377 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.698058 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:34.699607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:34.698812 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "postgres"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m00:38:34.700535 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:34.701226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.702051 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m00:38:34.703942 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:38:34.703150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.705609 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:38:34.709049 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.711004 [debug] [ThreadPool]: On list_postgres: Close
[0m00:38:34.713022 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:38:34.713180 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.716987 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:34.713664 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.716330 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:38:34.717215 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:34.720098 [info ] [MainThread]: 
[0m00:38:34.719844 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.720854 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "stg_orders" already exists

[0m00:38:34.722063 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:34.722258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:34.722411 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.723771 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m00:38:34.725624 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m00:38:34.722820 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: ROLLBACK
[0m00:38:34.724515 [info ] [MainThread]: 
[0m00:38:34.726616 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:34.724671 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:34.727653 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:34.727582 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m00:38:34.729008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.727928 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:38:34.729952 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:34.728701 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:34.730664 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m00:38:34.733238 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:34.732078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd4b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddbc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf35820>]}
[0m00:38:34.732633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:34.733518 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:34.733669 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:34.735847 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.737462 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.738684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:34.740423 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.737363 [debug] [MainThread]: Flushing usage events
[0m00:38:34.739135 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: Close
[0m00:38:34.745616 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:34.743559 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:34.741589 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.746935 [debug] [Thread-1  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "stg_orders" already exists
  compiled Code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m00:38:34.749003 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:34.748542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.751792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e23a2d4-18ce-466a-9434-6e52e77493d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6190d0>]}
[0m00:38:34.749951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f9640d-e02f-4495-8220-d15ce593feec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae8c7c0>]}
[0m00:38:34.750368 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m00:38:34.753632 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_orders ......................... [[31mERROR[0m in 0.19s]
[0m00:38:34.751968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.754843 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:34.755663 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_orders
[0m00:38:34.757351 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:34.757670 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.757880 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:34.762493 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.763423 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.764338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:34.760322 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:34.761555 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.760453 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.768777 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:34.770130 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.774456 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.769246 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.775804 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.772771 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.776093 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:34.776493 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:34.777816 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:34.777394 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.779331 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:34.779555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.781147 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.781546 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:34.782759 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:34.787622 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.782755 [debug] [MainThread]: On master: Close
[0m00:38:34.787836 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:34.791224 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:34.788500 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.788597 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.789194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e23a2d4-18ce-466a-9434-6e52e77493d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df7d790>]}
[0m00:38:34.790350 [info ] [MainThread]: 
[0m00:38:34.792687 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.793008 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:34.794913 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.794145 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m00:38:34.794838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:34.793488 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:34.796329 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.798417 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:34.798629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:34.798559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e23a2d4-18ce-466a-9434-6e52e77493d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7fe4f0>]}
[0m00:38:34.797387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:34.800199 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:34.802421 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m00:38:34.803300 [info ] [MainThread]: 
[0m00:38:34.803403 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.804659 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:34.805278 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.807297 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.806841 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:34.808068 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.808778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:34.809828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:34.810163 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:38:34.810513 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.814323 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.815159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:34.815451 [info ] [MainThread]: 
[0m00:38:34.817122 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:38:34.817518 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m00:38:34.818143 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m00:38:34.820365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ee108e3-152a-47cc-bdb9-4e4349c55e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaaf82b0>]}
[0m00:38:34.819062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc482a4c-33c4-4d8b-97af-69d5d65e0b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33804f0>]}
[0m00:38:34.817882 [info ] [MainThread]: 
[0m00:38:34.821972 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/staging/stg_orders.sql)[0m
[0m00:38:34.821066 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.821418 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:34.821634 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:34.821554 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:38:34.823687 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.823031 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.822894 [error] [MainThread]:   relation "stg_orders" already exists
[0m00:38:34.824159 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.825230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:34.825017 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.824504 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:38:34.825543 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m00:38:34.826161 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.829631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:34.829734 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:34.831270 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:34.832432 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.830647 [info ] [MainThread]: 
[0m00:38:34.833433 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.834527 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.836245 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.835718 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m00:38:34.835507 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.835211 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:38:34.837302 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.841615 [debug] [MainThread]: On master: Close
[0m00:38:34.838711 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.843062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:34.837919 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:38:34.838845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e198feb-5c75-4d49-8861-ceea87f2c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d11dc70>]}
[0m00:38:34.839686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bcdfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd034c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae7b130>]}
[0m00:38:34.848826 [info ] [MainThread]: 
[0m00:38:34.849894 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:34.845885 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.849986 [debug] [ThreadPool]: On list_postgres: Close
[0m00:38:34.851247 [debug] [MainThread]: Flushing usage events
[0m00:38:34.853813 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.853473 [debug] [MainThread]: On master: Close
[0m00:38:34.857475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:34.855878 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.858795 [info ] [MainThread]: 
[0m00:38:34.860859 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:34.861014 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:34.865149 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.868203 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.868439 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.869412 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:34.872093 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_payments
[0m00:38:34.870227 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.873774 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m00:38:34.877665 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_payments ................................ [RUN]
[0m00:38:34.878320 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_customers ............................... [RUN]
[0m00:38:34.878179 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.876647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.879798 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:34.882580 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:34.883115 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_payments
[0m00:38:34.881409 [debug] [MainThread]: On master: Close
[0m00:38:34.884123 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m00:38:34.886590 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m00:38:34.885243 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_payments
[0m00:38:34.890886 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m00:38:34.886984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:34.892102 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m00:38:34.893390 [info ] [MainThread]: 
[0m00:38:34.892573 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m00:38:34.898194 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:34.900099 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_payments
[0m00:38:34.899931 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:34.899219 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:34.901581 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m00:38:34.902136 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:34.910280 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:34.912063 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:34.913227 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:34.914754 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:34.916724 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.917741 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:34.918830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:34.922674 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m00:38:34.924451 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.925339 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:34.925350 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m00:38:34.927041 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:34.927681 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:34.929191 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: BEGIN
[0m00:38:34.929703 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m00:38:34.930230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:34.931177 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_customers ............................... [RUN]
[0m00:38:34.931502 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m00:38:34.931149 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:34.935293 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m00:38:34.934249 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:34.935833 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:34.936118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:34.936627 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m00:38:34.937860 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:34.938175 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.943193 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.938940 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m00:38:34.941949 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:34.945308 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "postgres"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m00:38:34.944116 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:34.945261 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.949024 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.948634 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:38:34.949815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:34.948140 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "postgres"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m00:38:34.947818 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m00:38:34.954701 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:34.954239 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:38:34.955691 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m00:38:34.959072 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:34.958472 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:38:34.959873 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.963052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:34.961420 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:34.965541 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:38:34.966627 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:38:34.960752 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:34.968891 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m00:38:34.970951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e23a2d4-18ce-466a-9434-6e52e77493d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d39deb0>]}
[0m00:38:34.971942 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:34.972865 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.973623 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.969475 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m00:38:34.975176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:34.976446 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.977064 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.977857 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.978690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.979340 [debug] [MainThread]: On master: Close
[0m00:38:34.980186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:34.981502 [info ] [MainThread]: 
[0m00:38:34.986830 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m00:38:34.980318 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m00:38:34.988830 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:34.990065 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m00:38:34.988475 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:34.991342 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m00:38:34.991554 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.992745 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:38:34.995841 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:34.997048 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "postgres"."public"."stg_payments__dbt_backup" cascade
[0m00:38:34.998272 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m00:38:34.997934 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:34.998168 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:38:34.999894 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_payments
[0m00:38:35.000870 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:35.001094 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:35.001253 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_payments ................................ [RUN]
[0m00:38:35.006239 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m00:38:34.999292 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "postgres"."public"."stg_customers__dbt_backup" cascade
[0m00:38:35.008418 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:38:35.007570 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:35.003006 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: Close
[0m00:38:35.007744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:35.009632 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:35.011360 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc482a4c-33c4-4d8b-97af-69d5d65e0b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2621550>]}
[0m00:38:35.010264 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_payments
[0m00:38:35.014700 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m00:38:35.015584 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_payments ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m00:38:35.016238 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_payments
[0m00:38:35.018107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:35.021812 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:35.022619 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "postgres"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m00:38:35.017350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ee108e3-152a-47cc-bdb9-4e4349c55e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d97670>]}
[0m00:38:35.023404 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m00:38:35.020511 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_payments
[0m00:38:35.024470 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m00:38:35.025834 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:38:35.026982 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:35.027730 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:35.029015 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_payments
[0m00:38:35.028226 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:35.029881 [debug] [MainThread]: On master: BEGIN
[0m00:38:35.030665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:35.026738 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m00:38:35.031625 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:38:35.033190 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:35.033742 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:38:35.034558 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:35.035562 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "stg_customers" already exists

[0m00:38:35.035855 [debug] [MainThread]: On master: BEGIN
[0m00:38:35.037047 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:35.037010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:35.036620 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m00:38:35.037865 [debug] [MainThread]: On master: COMMIT
[0m00:38:35.039158 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m00:38:35.039894 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:35.041402 [debug] [MainThread]: On master: COMMIT
[0m00:38:35.040621 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m00:38:35.042359 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:35.043080 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:35.043739 [debug] [MainThread]: On master: Close
[0m00:38:35.043987 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:35.049503 [info ] [MainThread]: 
[0m00:38:35.046176 [debug] [MainThread]: On master: COMMIT
[0m00:38:35.045255 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m00:38:35.050827 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:35.050341 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:38:35.052285 [debug] [MainThread]: On master: COMMIT
[0m00:38:35.052950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:35.054211 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:35.055156 [debug] [MainThread]: On master: Close
[0m00:38:35.054415 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m00:38:35.056473 [info ] [MainThread]: 
[0m00:38:35.058886 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m00:38:35.059870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:35.054078 [debug] [Thread-1  ]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "stg_customers" already exists
  compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m00:38:35.060820 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m00:38:35.061565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e198feb-5c75-4d49-8861-ceea87f2c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c317790>]}
[0m00:38:35.057421 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m00:38:35.073509 [info ] [MainThread]: 
[0m00:38:35.075796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:35.072651 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.13s]
[0m00:38:35.077362 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:35.077580 [info ] [MainThread]: 
[0m00:38:35.077824 [info ] [MainThread]: 
[0m00:38:35.077826 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m00:38:35.079689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:35.080994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:38:35.078472 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: BEGIN
[0m00:38:35.083242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:35.082626 [info ] [MainThread]: 
[0m00:38:35.083862 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:35.085142 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:35.084659 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:38:35.082867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3380eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33ff250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2587a90>]}
[0m00:38:35.086032 [debug] [MainThread]: On master: BEGIN
[0m00:38:35.087254 [debug] [MainThread]: Flushing usage events
[0m00:38:35.086933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9fd4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaaf8130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9cfba90>]}
[0m00:38:35.087655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:35.089428 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:35.089791 [debug] [MainThread]: Flushing usage events
[0m00:38:35.090972 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:35.092682 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "postgres"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m00:38:35.095866 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:35.096634 [debug] [MainThread]: On master: COMMIT
[0m00:38:35.097209 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:35.097368 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:38:35.098109 [debug] [MainThread]: On master: COMMIT
[0m00:38:35.099490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:35.100295 [debug] [MainThread]: On master: Close
[0m00:38:35.101407 [info ] [MainThread]: 
[0m00:38:35.102532 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m00:38:35.103039 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:38:35.103705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:35.104403 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m00:38:35.105282 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m00:38:35.106114 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "stg_payments" already exists

[0m00:38:35.107054 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: ROLLBACK
[0m00:38:35.110675 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m00:38:35.111554 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m00:38:35.112337 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:35.115999 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: Close
[0m00:38:35.117418 [debug] [Thread-1  ]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "stg_payments" already exists
  compiled Code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m00:38:35.118061 [info ] [MainThread]: 
[0m00:38:35.118524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e23a2d4-18ce-466a-9434-6e52e77493d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5b6790>]}
[0m00:38:35.120002 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_payments ....................... [[31mERROR[0m in 0.11s]
[0m00:38:35.119234 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:38:35.121033 [info ] [MainThread]: 
[0m00:38:35.120768 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_payments
[0m00:38:35.122002 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/staging/stg_customers.sql)[0m
[0m00:38:35.123549 [error] [MainThread]:   relation "stg_customers" already exists
[0m00:38:35.124500 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m00:38:35.123659 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:35.125451 [info ] [MainThread]: 
[0m00:38:35.125769 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:35.126995 [debug] [MainThread]: On master: BEGIN
[0m00:38:35.126637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:38:35.127671 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:35.128481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d18d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5a1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3063a0>]}
[0m00:38:35.129857 [debug] [MainThread]: Flushing usage events
[0m00:38:35.133660 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:35.134686 [debug] [MainThread]: On master: COMMIT
[0m00:38:35.135441 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:35.136127 [debug] [MainThread]: On master: COMMIT
[0m00:38:35.137028 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:35.138363 [debug] [MainThread]: On master: Close
[0m00:38:35.139367 [info ] [MainThread]: 
[0m00:38:35.140306 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m00:38:35.141256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:35.142089 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m00:38:35.153743 [info ] [MainThread]: 
[0m00:38:35.154579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:38:35.155521 [info ] [MainThread]: 
[0m00:38:35.156476 [error] [MainThread]: [33mDatabase Error in model stg_payments (models/staging/stg_payments.sql)[0m
[0m00:38:35.157361 [error] [MainThread]:   relation "stg_payments" already exists
[0m00:38:35.158241 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m00:38:35.159055 [info ] [MainThread]: 
[0m00:38:35.159731 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:38:35.160612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3b77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d374430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5a1b50>]}
[0m00:38:35.161458 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:38:42.806045 | 1c34c4f2-09a7-496e-b6d6-17fd859186b1 ==============================
[0m00:38:42.806067 [info ] [MainThread]: Running with dbt=1.3.1


============================== 2023-01-04 00:38:42.806165 | 26c40f67-b635-4217-95ad-45ac72850abe ==============================
[0m00:38:42.806190 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:42.806903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_payments'], 'which': 'test', 'rpc_method': 'test'}
[0m00:38:42.807887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_orders'], 'which': 'test', 'rpc_method': 'test'}
[0m00:38:42.808720 [debug] [MainThread]: Tracking: tracking
[0m00:38:42.809704 [debug] [MainThread]: Tracking: tracking
[0m00:38:42.815951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad16b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad16b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad16b7c0>]}
[0m00:38:42.826070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6152880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6152790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61527f0>]}


============================== 2023-01-04 00:38:42.829179 | d20b1c5d-33f4-4ae4-9b68-45909910c4b9 ==============================
[0m00:38:42.829218 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:38:42.830741 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_customers'], 'which': 'test', 'rpc_method': 'test'}
[0m00:38:42.831998 [debug] [MainThread]: Tracking: tracking
[0m00:38:42.851765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b210850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b210760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2107c0>]}
[0m00:38:42.870892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:42.871917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:42.876417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26c40f67-b635-4217-95ad-45ac72850abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf470d0>]}
[0m00:38:42.877955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:42.879009 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:42.884045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c34c4f2-09a7-496e-b6d6-17fd859186b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f2e0d0>]}
[0m00:38:42.905980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:42.907359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:42.912936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd20b1c5d-33f4-4ae4-9b68-45909910c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afec0d0>]}
[0m00:38:42.919429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26c40f67-b635-4217-95ad-45ac72850abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae8ab790>]}
[0m00:38:42.920713 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:42.921980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c40f67-b635-4217-95ad-45ac72850abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf12c4f0>]}
[0m00:38:42.923073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c34c4f2-09a7-496e-b6d6-17fd859186b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa810ff10>]}
[0m00:38:42.923926 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:42.924232 [info ] [MainThread]: 
[0m00:38:42.924863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c34c4f2-09a7-496e-b6d6-17fd859186b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa789dcd0>]}
[0m00:38:42.925678 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:42.926614 [info ] [MainThread]: 
[0m00:38:42.927383 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:42.927961 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:42.929967 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:42.934529 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:42.936108 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:42.936965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:42.937068 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:42.938824 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:42.939959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:42.943096 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:42.944039 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:42.944923 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:42.945620 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:42.946637 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:42.947412 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:42.947988 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:38:42.950008 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:42.950301 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:42.951039 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:42.952573 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:42.953099 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:42.953872 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:42.956387 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:42.960388 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:42.960572 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:42.962062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:42.962681 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:42.963489 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:42.964292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:42.967881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd20b1c5d-33f4-4ae4-9b68-45909910c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1dad90>]}
[0m00:38:42.968723 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:42.968894 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:38:42.970359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd20b1c5d-33f4-4ae4-9b68-45909910c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1d3d90>]}
[0m00:38:42.969946 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:42.969516 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:42.971566 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:42.971837 [info ] [MainThread]: 
[0m00:38:42.972320 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:42.973351 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:42.974099 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:42.976215 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:38:42.976359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:42.977668 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:38:42.978286 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:42.979065 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:42.979963 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:42.980723 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:42.983628 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:42.983543 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:42.984542 [debug] [MainThread]: On master: BEGIN
[0m00:38:42.984815 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:42.985863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:42.985484 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:38:42.986664 [debug] [MainThread]: On master: BEGIN
[0m00:38:42.988625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:42.988168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:42.992818 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:42.993750 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:42.994549 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:42.994677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:42.995314 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:42.997941 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:43.000623 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.001728 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:38:43.002435 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:38:43.004318 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:38:43.004515 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:38:43.004786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c40f67-b635-4217-95ad-45ac72850abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadccb580>]}
[0m00:38:43.007343 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:43.006620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c34c4f2-09a7-496e-b6d6-17fd859186b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c9d4f0>]}
[0m00:38:43.008599 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:38:43.008961 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:43.009040 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.010164 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.010397 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:38:43.011668 [debug] [MainThread]: On master: BEGIN
[0m00:38:43.012531 [debug] [MainThread]: On master: BEGIN
[0m00:38:43.013283 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:38:43.014434 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:43.015976 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:38:43.014645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:43.016228 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.017654 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.018257 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:43.018699 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.019613 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.020927 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.020460 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:38:43.021951 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.023534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:43.024706 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:43.024177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:43.025897 [debug] [MainThread]: On master: Close
[0m00:38:43.027011 [debug] [MainThread]: On master: Close
[0m00:38:43.032230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:43.028579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:43.033384 [info ] [MainThread]: 
[0m00:38:43.033731 [info ] [MainThread]: 
[0m00:38:43.034147 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.037862 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:38:43.038824 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:38:43.042111 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:38:43.044985 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:38:43.046597 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:38:43.047154 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:38:43.047212 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:38:43.048239 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [RUN]
[0m00:38:43.050442 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m00:38:43.052391 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:38:43.051979 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.053530 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:38:43.055867 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:38:43.054215 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:38:43.054676 [debug] [MainThread]: On master: BEGIN
[0m00:38:43.056864 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:38:43.057612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:43.057368 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:38:43.064875 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.066222 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.067295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:43.068347 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:38:43.070441 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:38:43.074037 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:38:43.074335 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.074312 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.075893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd20b1c5d-33f4-4ae4-9b68-45909910c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd5ba90>]}
[0m00:38:43.075813 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:38:43.076221 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:38:43.077488 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:43.082513 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.083610 [debug] [MainThread]: On master: BEGIN
[0m00:38:43.085085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:43.086129 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.087143 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.088187 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.089431 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:43.089779 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:38:43.089875 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:38:43.091674 [debug] [MainThread]: On master: Close
[0m00:38:43.094792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:43.097144 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:38:43.096426 [info ] [MainThread]: 
[0m00:38:43.097615 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: BEGIN
[0m00:38:43.097658 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:38:43.099358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:43.100483 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m00:38:43.101994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:43.105994 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.107064 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:38:43.106734 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:38:43.107916 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "postgres"."public"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m00:38:43.108071 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:38:43.108342 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:38:43.110853 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."public"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m00:38:43.111202 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:43.110240 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m00:38:43.114572 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:43.115210 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:38:43.115086 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.116152 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:38:43.116783 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.116838 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
[0m00:38:43.117737 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:38:43.118332 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m00:38:43.118806 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
[0m00:38:43.120009 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m00:38:43.120712 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [[32mPASS[0m in 0.07s]
[0m00:38:43.121823 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.07s]
[0m00:38:43.122428 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:38:43.123919 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:38:43.124321 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:38:43.125145 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:38:43.125979 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_payments_payment_id ............................. [RUN]
[0m00:38:43.126961 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:38:43.127286 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_orders_order_id ................................. [RUN]
[0m00:38:43.128645 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:38:43.130744 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:38:43.131778 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:38:43.130730 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:38:43.132275 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.133086 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:38:43.133915 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:38:43.134665 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:38:43.136885 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:38:43.140574 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:38:43.140649 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.141788 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:38:43.143752 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:38:43.144787 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.145941 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:38:43.146569 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:38:43.148183 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:38:43.147615 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:38:43.149123 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m00:38:43.150186 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:38:43.150198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:43.151042 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m00:38:43.151145 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:38:43.153882 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m00:38:43.154821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:43.153499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:43.156880 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.157777 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:38:43.158642 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m00:38:43.159802 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:38:43.160006 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.161074 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:43.160815 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:38:43.161716 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:38:43.164030 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres"."public"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m00:38:43.164649 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:38:43.163968 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.167256 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m00:38:43.167218 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:43.168010 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:43.168311 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m00:38:43.169966 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.170641 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_payments_payment_id ................................... [[32mPASS[0m in 0.04s]
[0m00:38:43.170642 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.172204 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:38:43.171032 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m00:38:43.172410 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m00:38:43.173531 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:38:43.173992 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m00:38:43.174803 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m00:38:43.175734 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_payments_payment_id ............................... [RUN]
[0m00:38:43.176543 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.05s]
[0m00:38:43.177558 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m00:38:43.178141 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:38:43.181033 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:38:43.179173 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:38:43.182051 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:38:43.183475 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:38:43.183048 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:38:43.184533 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:38:43.186374 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_customers_customer_id ............................. [RUN]
[0m00:38:43.185711 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_orders_order_id ................................... [RUN]
[0m00:38:43.188341 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:38:43.189693 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:38:43.190570 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:38:43.190073 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:38:43.190873 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:38:43.192044 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:38:43.192785 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:38:43.194300 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.195552 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:38:43.198056 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:38:43.198581 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:38:43.198752 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:38:43.201510 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:38:43.202491 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: BEGIN
[0m00:38:43.202497 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.202695 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.203306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:43.204330 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:38:43.204000 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:38:43.207314 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:38:43.207663 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:38:43.209819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.210690 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:38:43.210738 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:38:43.211742 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m00:38:43.210744 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:38:43.213993 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:38:43.214794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:43.215165 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m00:38:43.217720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:38:43.217936 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:43.220257 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.221235 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m00:38:43.221585 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.222698 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:38:43.222195 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m00:38:43.223650 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:38:43.222854 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:38:43.224286 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_payments_payment_id ..................................... [[32mPASS[0m in 0.05s]
[0m00:38:43.226041 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:38:43.225251 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:38:43.227294 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:38:43.229566 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:43.230247 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:43.230037 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:43.231420 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.232322 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.232575 [debug] [Thread-1  ]: finished collecting timing info
[0m00:38:43.233166 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m00:38:43.233852 [debug] [MainThread]: On master: BEGIN
[0m00:38:43.234413 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m00:38:43.235378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:43.235185 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m00:38:43.236123 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m00:38:43.238870 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.05s]
[0m00:38:43.237330 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.05s]
[0m00:38:43.239557 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:38:43.240295 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:38:43.242002 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:43.242125 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:38:43.243342 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.242934 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.243650 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.244821 [debug] [MainThread]: On master: BEGIN
[0m00:38:43.246622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:43.244289 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.245698 [debug] [MainThread]: On master: BEGIN
[0m00:38:43.248265 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.248826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:43.250068 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.252144 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.253923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:43.254583 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.255413 [debug] [MainThread]: On master: Close
[0m00:38:43.256296 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:38:43.257807 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.256427 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.257162 [info ] [MainThread]: 
[0m00:38:43.258653 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:43.259367 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.259788 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m00:38:43.260544 [debug] [MainThread]: On master: COMMIT
[0m00:38:43.261927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:43.261550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:43.263819 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m00:38:43.262895 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:43.264404 [debug] [MainThread]: On master: Close
[0m00:38:43.265748 [debug] [MainThread]: On master: Close
[0m00:38:43.267000 [info ] [MainThread]: 
[0m00:38:43.267528 [info ] [MainThread]: 
[0m00:38:43.269824 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m00:38:43.271986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:43.270896 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m00:38:43.273676 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m00:38:43.274193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:43.275174 [info ] [MainThread]: 
[0m00:38:43.275188 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:38:43.275959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:43.277217 [info ] [MainThread]: 
[0m00:38:43.278413 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:38:43.279436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5631e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5631be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ed6cd0>]}
[0m00:38:43.280445 [debug] [MainThread]: Flushing usage events
[0m00:38:43.292944 [info ] [MainThread]: 
[0m00:38:43.293316 [info ] [MainThread]: 
[0m00:38:43.294166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:43.294906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:43.295685 [info ] [MainThread]: 
[0m00:38:43.296636 [info ] [MainThread]: 
[0m00:38:43.297891 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:38:43.298744 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:38:43.299672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaceec070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacef0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac655ee0>]}
[0m00:38:43.300829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6eed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6eeb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b025ac0>]}
[0m00:38:43.301548 [debug] [MainThread]: Flushing usage events
[0m00:38:43.302247 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:39:23.226308 | a2ada522-09ae-410c-a4c5-4e2e27a8d961 ==============================
[0m00:39:23.226328 [info ] [MainThread]: Running with dbt=1.3.1


============================== 2023-01-04 00:39:23.226429 | af04e599-8faa-4499-8da6-672a5bf65bc9 ==============================
[0m00:39:23.226448 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:39:23.227732 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_payments'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:39:23.228396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:39:23.228928 [debug] [MainThread]: Tracking: tracking
[0m00:39:23.229708 [debug] [MainThread]: Tracking: tracking
[0m00:39:23.235039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66eb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66eb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66eb820>]}


============================== 2023-01-04 00:39:23.235889 | 63785472-b060-4291-a6a0-666e5f974cc5 ==============================
[0m00:39:23.235938 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:39:23.237831 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['stg_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:39:23.238812 [debug] [MainThread]: Tracking: tracking
[0m00:39:23.245123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999a5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999a5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999a57f0>]}
[0m00:39:23.246415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e3a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e3a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e3a7c0>]}
[0m00:39:23.283396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:23.284472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:23.289432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af04e599-8faa-4499-8da6-672a5bf65bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64c60d0>]}
[0m00:39:23.298708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:23.298548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:23.299636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:23.300415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:23.305514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2ada522-09ae-410c-a4c5-4e2e27a8d961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c160d0>]}
[0m00:39:23.305996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63785472-b060-4291-a6a0-666e5f974cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997810d0>]}
[0m00:39:23.327510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af04e599-8faa-4499-8da6-672a5bf65bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e3c2b0>]}
[0m00:39:23.328788 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:23.329762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af04e599-8faa-4499-8da6-672a5bf65bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa86b5c10>]}
[0m00:39:23.331479 [info ] [MainThread]: 
[0m00:39:23.332722 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:23.334122 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:39:23.341126 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:39:23.341952 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:39:23.343023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:23.349838 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:39:23.351365 [debug] [ThreadPool]: On list_postgres: Close
[0m00:39:23.353050 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:23.355533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63785472-b060-4291-a6a0-666e5f974cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b962f10>]}
[0m00:39:23.356389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2ada522-09ae-410c-a4c5-4e2e27a8d961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a17f40>]}
[0m00:39:23.356966 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:23.357266 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:23.357647 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:23.358746 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:23.359833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2ada522-09ae-410c-a4c5-4e2e27a8d961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88def3d0>]}
[0m00:39:23.358631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63785472-b060-4291-a6a0-666e5f974cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0f0cd0>]}
[0m00:39:23.361611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:23.363195 [info ] [MainThread]: 
[0m00:39:23.363453 [info ] [MainThread]: 
[0m00:39:23.364417 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:23.365274 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:23.365957 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:39:23.366659 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:39:23.367563 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.368320 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:23.369105 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:23.372172 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:39:23.373001 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:39:23.373421 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:39:23.374103 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:39:23.374237 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:23.374963 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:39:23.375753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:23.376252 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:23.377117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:23.378887 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:23.381181 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:23.382276 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:23.383185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:23.383196 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:39:23.385785 [debug] [ThreadPool]: On list_postgres: Close
[0m00:39:23.384804 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:39:23.387977 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:23.388773 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.389146 [debug] [ThreadPool]: On list_postgres: Close
[0m00:39:23.389813 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:23.391555 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:23.391652 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:23.392360 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:23.393942 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:23.394563 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:39:23.394801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:23.396267 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:23.396949 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:23.397932 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:23.398538 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:23.400241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:23.401716 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.402383 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.402673 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:23.403474 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.404463 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:23.405950 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.405274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:23.406937 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:23.408064 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:39:23.408263 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:23.409587 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:23.410567 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:23.411662 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:39:23.412019 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:23.412887 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.413569 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:23.414564 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:23.414163 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.415234 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:23.416310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:23.415873 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:23.417807 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:23.419717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:23.421498 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:23.422420 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:23.423314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:23.424055 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:39:23.425946 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.425855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af04e599-8faa-4499-8da6-672a5bf65bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa724a4f0>]}
[0m00:39:23.426860 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:23.428195 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:39:23.427918 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:23.429069 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:23.428488 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:23.429823 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.430396 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:23.431938 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.434244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:23.433076 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:39:23.434805 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.436376 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:23.436889 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.434850 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:39:23.437877 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:23.438474 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.439469 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:23.440497 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.440888 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:23.441848 [debug] [MainThread]: On master: Close
[0m00:39:23.442960 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.443761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:23.444214 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.445164 [info ] [MainThread]: 
[0m00:39:23.445825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:23.446549 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.447974 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.448673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:23.451518 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.452543 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.453338 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:23.453536 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:23.455053 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.455721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:23.455889 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m00:39:23.457129 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_customers ............................... [RUN]
[0m00:39:23.458263 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m00:39:23.459172 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m00:39:23.460026 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m00:39:23.460289 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:39:23.461255 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:39:23.462330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2ada522-09ae-410c-a4c5-4e2e27a8d961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879b6c40>]}
[0m00:39:23.463198 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m00:39:23.463180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63785472-b060-4291-a6a0-666e5f974cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a505070>]}
[0m00:39:23.465043 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:23.463538 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:23.465970 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.466388 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.466944 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.467584 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.468215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:23.468921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:23.469254 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.470262 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:23.469891 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.470513 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.471123 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m00:39:23.471416 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.472121 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.473070 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.473804 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.474504 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.474964 [debug] [MainThread]: On master: Close
[0m00:39:23.476230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:23.475640 [debug] [MainThread]: On master: Close
[0m00:39:23.477328 [info ] [MainThread]: 
[0m00:39:23.479735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:23.480936 [info ] [MainThread]: 
[0m00:39:23.487736 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_orders
[0m00:39:23.489012 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_orders .................................. [RUN]
[0m00:39:23.490348 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m00:39:23.491275 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_orders
[0m00:39:23.492048 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_orders
[0m00:39:23.492197 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_payments
[0m00:39:23.493636 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_payments ................................ [RUN]
[0m00:39:23.494230 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m00:39:23.494956 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
[0m00:39:23.495310 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m00:39:23.496505 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_payments
[0m00:39:23.497975 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_payments
[0m00:39:23.500454 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:23.500338 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:39:23.501406 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_orders
[0m00:39:23.501370 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m00:39:23.502194 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m00:39:23.505858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:23.508362 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:23.509016 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_payments
[0m00:39:23.511313 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.512096 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:39:23.512782 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "postgres"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m00:39:23.516721 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:39:23.520922 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:39:23.521835 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m00:39:23.522958 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:39:23.523744 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m00:39:23.525100 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:39:23.526085 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:39:23.527001 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:39:23.527643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:39:23.527844 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m00:39:23.529053 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:23.530826 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m00:39:23.534020 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:23.535014 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:39:23.535337 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:39:23.535989 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "postgres"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m00:39:23.536680 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: BEGIN
[0m00:39:23.538009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:23.538635 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m00:39:23.538959 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:39:23.539439 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:39:23.540868 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m00:39:23.542377 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.543040 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.543839 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:39:23.543811 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:39:23.544635 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m00:39:23.545277 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "postgres"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "postgres"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m00:39:23.545837 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m00:39:23.546319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:39:23.547287 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "postgres"."public"."stg_customers__dbt_backup" cascade
[0m00:39:23.548950 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:39:23.549492 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:39:23.549272 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:39:23.550804 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:39:23.551144 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:23.552278 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:39:23.552743 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m00:39:23.553548 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:39:23.554422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af04e599-8faa-4499-8da6-672a5bf65bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6482370>]}
[0m00:39:23.555677 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m00:39:23.554727 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."public"."stg_payments" rename to "stg_payments__dbt_backup"
[0m00:39:23.556405 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m00:39:23.556631 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:39:23.558098 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:23.558979 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.559182 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:39:23.559869 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.560686 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m00:39:23.561379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:23.562325 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:39:23.563979 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m00:39:23.564845 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:39:23.565760 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m00:39:23.567121 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.567768 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.568813 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.569516 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.570436 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.570717 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m00:39:23.571562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.572118 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "postgres"."public"."stg_orders__dbt_backup" cascade
[0m00:39:23.572732 [debug] [MainThread]: On master: Close
[0m00:39:23.574024 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m00:39:23.574253 [info ] [MainThread]: 
[0m00:39:23.574341 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:39:23.575032 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:39:23.575887 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m00:39:23.576733 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m00:39:23.577106 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:23.577565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:23.578587 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: Close
[0m00:39:23.579446 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m00:39:23.579801 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.580324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63785472-b060-4291-a6a0-666e5f974cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b966760>]}
[0m00:39:23.582177 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m00:39:23.583256 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_orders
[0m00:39:23.584583 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m00:39:23.584846 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:23.585614 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "postgres"."public"."stg_payments__dbt_backup" cascade
[0m00:39:23.586272 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.588587 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.588705 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:39:23.589607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:23.595305 [info ] [MainThread]: 
[0m00:39:23.592597 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:23.597345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:23.598879 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.598030 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: Close
[0m00:39:23.600026 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.599134 [info ] [MainThread]: 
[0m00:39:23.600819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2ada522-09ae-410c-a4c5-4e2e27a8d961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c3a3d0>]}
[0m00:39:23.601099 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.601672 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:39:23.602850 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_payments ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m00:39:23.603025 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.605484 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.603927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e121f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7267580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64ea580>]}
[0m00:39:23.606029 [debug] [MainThread]: On master: Close
[0m00:39:23.605118 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_payments
[0m00:39:23.606963 [debug] [MainThread]: Flushing usage events
[0m00:39:23.608051 [info ] [MainThread]: 
[0m00:39:23.609126 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:23.610157 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m00:39:23.610804 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.611782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:23.612361 [debug] [MainThread]: On master: BEGIN
[0m00:39:23.613186 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m00:39:23.614499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:23.620349 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:23.621676 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.623779 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:23.624845 [debug] [MainThread]: On master: COMMIT
[0m00:39:23.625612 [info ] [MainThread]: 
[0m00:39:23.625875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:23.626523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:23.627180 [debug] [MainThread]: On master: Close
[0m00:39:23.627933 [info ] [MainThread]: 
[0m00:39:23.628763 [info ] [MainThread]: 
[0m00:39:23.629198 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:39:23.631030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4f0d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e92d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997b84f0>]}
[0m00:39:23.629850 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m00:39:23.632607 [debug] [MainThread]: Flushing usage events
[0m00:39:23.633055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:23.634751 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m00:39:23.646728 [info ] [MainThread]: 
[0m00:39:23.648016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:23.649138 [info ] [MainThread]: 
[0m00:39:23.650169 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:39:23.651276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8856bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879bf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c81a30>]}
[0m00:39:23.652265 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:39:26.113771 | 92e7dab0-4ba1-4286-8905-08621c5e076d ==============================
[0m00:39:26.113794 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:39:26.114529 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_customers'], 'which': 'test', 'rpc_method': 'test'}
[0m00:39:26.115539 [debug] [MainThread]: Tracking: tracking


============================== 2023-01-04 00:39:26.119069 | 5684e797-e6c8-4fae-95f5-7045bf7e023b ==============================
[0m00:39:26.119086 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:39:26.120518 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_orders'], 'which': 'test', 'rpc_method': 'test'}
[0m00:39:26.121752 [debug] [MainThread]: Tracking: tracking
[0m00:39:26.121966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa933a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa933a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa933a7c0>]}


============================== 2023-01-04 00:39:26.135752 | 42c53dc0-02fb-4ee3-b071-074d61bc894b ==============================
[0m00:39:26.135772 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:39:26.136811 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['stg_payments'], 'which': 'test', 'rpc_method': 'test'}
[0m00:39:26.137729 [debug] [MainThread]: Tracking: tracking
[0m00:39:26.141059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a45850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a45760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a457c0>]}
[0m00:39:26.153253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb308c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb308c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb308c7c0>]}
[0m00:39:26.166512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:26.168626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:26.175446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92e7dab0-4ba1-4286-8905-08621c5e076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91150d0>]}
[0m00:39:26.193514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:26.194412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:26.199636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5684e797-e6c8-4fae-95f5-7045bf7e023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08210d0>]}
[0m00:39:26.201156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:26.202116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:26.207240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c53dc0-02fb-4ee3-b071-074d61bc894b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e690d0>]}
[0m00:39:26.220217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92e7dab0-4ba1-4286-8905-08621c5e076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa7a790>]}
[0m00:39:26.221952 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:26.223442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e7dab0-4ba1-4286-8905-08621c5e076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2fb4f0>]}
[0m00:39:26.225532 [info ] [MainThread]: 
[0m00:39:26.227046 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:26.229104 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:26.237223 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:26.239125 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:26.240206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:26.243128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5684e797-e6c8-4fae-95f5-7045bf7e023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2185790>]}
[0m00:39:26.244196 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:26.245158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5684e797-e6c8-4fae-95f5-7045bf7e023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a064f0>]}
[0m00:39:26.245023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c53dc0-02fb-4ee3-b071-074d61bc894b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c69f40>]}
[0m00:39:26.246270 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:26.246933 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.247167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c53dc0-02fb-4ee3-b071-074d61bc894b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50413d0>]}
[0m00:39:26.247071 [info ] [MainThread]: 
[0m00:39:26.247776 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:26.249008 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:26.249381 [info ] [MainThread]: 
[0m00:39:26.249757 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:26.251222 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:26.250916 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:26.252977 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:26.253789 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:39:26.255851 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:26.256850 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:26.258446 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:26.258111 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:26.258857 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:26.260002 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:26.261164 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:26.260746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:26.261633 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:26.262528 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:26.263464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:26.264175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:26.267585 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.268539 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:26.269402 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.269422 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:26.269662 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.270405 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:26.271509 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:26.272210 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:26.272888 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:26.273127 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:39:26.275355 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:26.275554 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:39:26.275794 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:39:26.276382 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:26.277885 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:26.278424 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:26.278245 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:26.279054 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:26.280585 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:26.281253 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:26.282111 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:26.283457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:26.283194 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:26.285807 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:26.286817 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.287356 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:26.288575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:26.288040 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.289252 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.289801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:26.290383 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:26.291804 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:26.293889 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.294636 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:39:26.294957 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:26.296554 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:26.294934 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.297649 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.297402 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:26.298505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:26.299369 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:26.299249 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:39:26.302409 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:26.303431 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:26.304324 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.305275 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.306133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:26.307574 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.307781 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:39:26.308453 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.309626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:26.309729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e7dab0-4ba1-4286-8905-08621c5e076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e99be0>]}
[0m00:39:26.311117 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:26.311708 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.312053 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.313280 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.312610 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.314447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:26.314467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:26.314568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:26.315376 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.316545 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.317253 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.317575 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:26.318231 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.319652 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:26.320440 [debug] [MainThread]: On master: Close
[0m00:39:26.321006 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:39:26.321403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:26.322580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5684e797-e6c8-4fae-95f5-7045bf7e023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15a5eb0>]}
[0m00:39:26.322727 [info ] [MainThread]: 
[0m00:39:26.323582 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:26.324496 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:39:26.325118 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.326390 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.326548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c53dc0-02fb-4ee3-b071-074d61bc894b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb589d0a0>]}
[0m00:39:26.327477 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:26.329262 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:26.330174 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.331138 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.331782 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.332406 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.333076 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.334040 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:26.335083 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:39:26.334668 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:26.335385 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.336043 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m00:39:26.336377 [debug] [MainThread]: On master: Close
[0m00:39:26.336936 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.337862 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:39:26.338201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:26.339098 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:39:26.339655 [info ] [MainThread]: 
[0m00:39:26.338534 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.340444 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:39:26.341588 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:26.343001 [debug] [MainThread]: On master: Close
[0m00:39:26.344257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:26.345347 [info ] [MainThread]: 
[0m00:39:26.349956 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:39:26.350346 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:39:26.351980 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m00:39:26.353257 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.353236 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:39:26.354178 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:39:26.354521 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:39:26.355437 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:39:26.356682 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [RUN]
[0m00:39:26.356392 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:39:26.357871 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:39:26.358945 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:39:26.359757 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:39:26.363808 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:39:26.366792 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:39:26.368903 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:39:26.369176 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:39:26.369738 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.370614 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m00:39:26.371232 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:39:26.371702 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.371889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:26.372804 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:39:26.377669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.378651 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:39:26.379499 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:39:26.381098 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:39:26.381517 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:26.382752 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:39:26.383820 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.384713 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m00:39:26.385612 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m00:39:26.386754 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.05s]
[0m00:39:26.388049 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:39:26.388148 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:39:26.388368 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:39:26.388975 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:39:26.389667 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: BEGIN
[0m00:39:26.390542 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_customers_customer_id ............................. [RUN]
[0m00:39:26.390234 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m00:39:26.391125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:26.392036 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:39:26.391890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:26.393210 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:39:26.394181 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:39:26.396839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.397164 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.397950 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m00:39:26.398949 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:39:26.399633 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:39:26.400200 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "postgres"."public"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m00:39:26.401120 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."public"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m00:39:26.403609 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.403394 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:26.404579 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:39:26.405333 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:26.406312 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.407039 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:39:26.407233 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
[0m00:39:26.407575 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.408809 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
[0m00:39:26.409171 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m00:39:26.409803 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:39:26.410369 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [[32mPASS[0m in 0.05s]
[0m00:39:26.410581 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m00:39:26.411358 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m00:39:26.412192 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m00:39:26.413046 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.06s]
[0m00:39:26.413533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:26.414531 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:39:26.415431 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:39:26.416279 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_payments_payment_id ............................. [RUN]
[0m00:39:26.418134 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:39:26.417101 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:39:26.418581 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:39:26.419101 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_orders_order_id ................................. [RUN]
[0m00:39:26.419685 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.419856 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:39:26.420812 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:39:26.421146 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:39:26.422246 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:39:26.422909 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:39:26.423680 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:39:26.425588 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:39:26.428470 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.429131 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:39:26.429293 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:26.429440 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:39:26.431465 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.431982 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.432377 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m00:39:26.432580 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:39:26.433057 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:39:26.433716 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m00:39:26.436438 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:39:26.436510 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.04s]
[0m00:39:26.436569 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:39:26.437947 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:39:26.438649 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m00:39:26.439181 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:39:26.440102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:26.440477 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m00:39:26.440399 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:26.441964 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.441684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:26.442611 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.443631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:26.445372 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.446185 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m00:39:26.446874 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.446876 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m00:39:26.447558 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:39:26.448942 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.448942 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres"."public"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m00:39:26.449391 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:26.449717 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.451409 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.451595 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:26.451479 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.452286 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.453915 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.453815 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m00:39:26.455554 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m00:39:26.456293 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m00:39:26.455242 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:26.457830 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_payments_payment_id ................................... [[32mPASS[0m in 0.04s]
[0m00:39:26.456956 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m00:39:26.458257 [debug] [MainThread]: On master: Close
[0m00:39:26.460038 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m00:39:26.460506 [info ] [MainThread]: 
[0m00:39:26.459100 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m00:39:26.461928 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m00:39:26.461013 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:39:26.462834 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:39:26.463685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:26.464002 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:39:26.465428 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m00:39:26.464632 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_payments_payment_id ............................... [RUN]
[0m00:39:26.466247 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_orders_order_id ................................... [RUN]
[0m00:39:26.468278 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:39:26.467669 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:39:26.469101 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:39:26.468785 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:39:26.469969 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:39:26.470676 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:39:26.476150 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:39:26.476725 [info ] [MainThread]: 
[0m00:39:26.476800 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:39:26.478021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:26.478911 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.479796 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.479598 [info ] [MainThread]: 
[0m00:39:26.480298 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:39:26.481332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:39:26.480914 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:39:26.482813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90586a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9058af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9086d00>]}
[0m00:39:26.483111 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:39:26.483645 [debug] [MainThread]: Flushing usage events
[0m00:39:26.484501 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:39:26.487557 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:39:26.489251 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m00:39:26.489702 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:39:26.490196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:26.490726 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: BEGIN
[0m00:39:26.491871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:26.495356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.496011 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:26.496207 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:39:26.496894 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m00:39:26.497547 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:39:26.498216 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:39:26.500323 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:26.500882 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:26.501958 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.502566 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:26.502848 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m00:39:26.503578 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m00:39:26.504470 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m00:39:26.505114 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m00:39:26.505882 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.04s]
[0m00:39:26.506471 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_payments_payment_id ..................................... [[32mPASS[0m in 0.04s]
[0m00:39:26.507458 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:39:26.507973 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m00:39:26.509521 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:26.510073 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:26.510370 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.511100 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.512406 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.511794 [debug] [MainThread]: On master: BEGIN
[0m00:39:26.513054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:26.513321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:26.518288 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.519039 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:26.519273 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.520067 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.521499 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.522186 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:26.540383 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.541247 [debug] [MainThread]: On master: COMMIT
[0m00:39:26.542152 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:26.542937 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:26.543606 [debug] [MainThread]: On master: Close
[0m00:39:26.544261 [debug] [MainThread]: On master: Close
[0m00:39:26.545156 [info ] [MainThread]: 
[0m00:39:26.546210 [info ] [MainThread]: 
[0m00:39:26.547403 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m00:39:26.546998 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m00:39:26.548381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:26.548987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:26.549504 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:39:26.550084 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m00:39:26.562329 [info ] [MainThread]: 
[0m00:39:26.562639 [info ] [MainThread]: 
[0m00:39:26.563222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:26.563739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:26.564798 [info ] [MainThread]: 
[0m00:39:26.564214 [info ] [MainThread]: 
[0m00:39:26.565295 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:39:26.565512 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:39:26.566225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff24e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff24bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff2d130>]}
[0m00:39:26.566820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e1af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e05070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e05100>]}
[0m00:39:26.567274 [debug] [MainThread]: Flushing usage events
[0m00:39:26.567789 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:39:28.152092 | f654a595-2fd6-46cb-9a0a-d3222e2d3d60 ==============================
[0m00:39:28.152115 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:39:28.152963 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:39:28.154048 [debug] [MainThread]: Tracking: tracking
[0m00:39:28.158908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943de850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943de760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943de7c0>]}


============================== 2023-01-04 00:39:28.186326 | e8747d87-e33c-4284-a2ca-6e150398309b ==============================
[0m00:39:28.186348 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:39:28.187425 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'select': ['orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:39:28.188434 [debug] [MainThread]: Tracking: tracking
[0m00:39:28.194505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0d8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0d8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0d87f0>]}
[0m00:39:28.201888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:28.203001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:28.207689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f654a595-2fd6-46cb-9a0a-d3222e2d3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941b90d0>]}
[0m00:39:28.239973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:28.241015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:28.242821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f654a595-2fd6-46cb-9a0a-d3222e2d3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fbb0d0>]}
[0m00:39:28.243702 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:28.244493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f654a595-2fd6-46cb-9a0a-d3222e2d3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96393c40>]}
[0m00:39:28.245952 [info ] [MainThread]: 
[0m00:39:28.246291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8747d87-e33c-4284-a2ca-6e150398309b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99eb40d0>]}
[0m00:39:28.247185 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:28.248718 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:39:28.255129 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:39:28.256197 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:39:28.257140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:28.264101 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:39:28.265979 [debug] [ThreadPool]: On list_postgres: Close
[0m00:39:28.267448 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_dbt_dev"
[0m00:39:28.268704 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_dbt_dev"
[0m00:39:28.269697 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='postgres', schema='dbt_dev', identifier=None)"
[0m00:39:28.273506 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbt_dev"
[0m00:39:28.274527 [debug] [ThreadPool]: On create_postgres_dbt_dev: BEGIN
[0m00:39:28.275415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:28.279881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8747d87-e33c-4284-a2ca-6e150398309b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c095f10>]}
[0m00:39:28.280707 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:28.281441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8747d87-e33c-4284-a2ca-6e150398309b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b823cd0>]}
[0m00:39:28.282042 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:28.282725 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbt_dev"
[0m00:39:28.283029 [info ] [MainThread]: 
[0m00:39:28.283344 [debug] [ThreadPool]: On create_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "create_postgres_dbt_dev"} */
create schema if not exists "dbt_dev"
[0m00:39:28.284258 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:28.285197 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m00:39:28.285601 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:39:28.286291 [debug] [ThreadPool]: On create_postgres_dbt_dev: COMMIT
[0m00:39:28.286952 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbt_dev"
[0m00:39:28.287527 [debug] [ThreadPool]: On create_postgres_dbt_dev: COMMIT
[0m00:39:28.288857 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m00:39:28.289603 [debug] [ThreadPool]: On create_postgres_dbt_dev: Close
[0m00:39:28.291503 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:28.292716 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:39:28.293564 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:39:28.294294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:28.295634 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:28.296505 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:28.297228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:28.299896 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m00:39:28.301476 [debug] [ThreadPool]: On list_postgres: Close
[0m00:39:28.302024 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:39:28.303096 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:28.303517 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:28.304045 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:28.307211 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:39:28.308061 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:28.308904 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:28.309336 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:28.309842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:28.310785 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:28.312698 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:28.314689 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:28.315239 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:28.315597 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:28.317015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:28.316492 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:28.318018 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:28.320779 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m00:39:28.321668 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:39:28.322555 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:28.322875 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:28.323419 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:28.324354 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:28.326321 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:28.327037 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:39:28.328480 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:28.328704 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:28.329487 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:28.330432 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:28.330988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:28.334554 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.335570 [debug] [MainThread]: On master: BEGIN
[0m00:39:28.336448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:28.336243 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:28.337699 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:28.338453 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:28.341181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:28.341110 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:39:28.341979 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.342994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:28.343292 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:28.344717 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:28.348423 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.349233 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:39:28.349398 [debug] [MainThread]: On master: BEGIN
[0m00:39:28.350836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f654a595-2fd6-46cb-9a0a-d3222e2d3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f5bc70>]}
[0m00:39:28.350816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:28.351739 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:28.353302 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.354007 [debug] [MainThread]: On master: BEGIN
[0m00:39:28.354886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:28.355566 [debug] [MainThread]: On master: COMMIT
[0m00:39:28.356268 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.356472 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:28.356972 [debug] [MainThread]: On master: COMMIT
[0m00:39:28.357497 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.358205 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:28.358784 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:28.359390 [debug] [MainThread]: On master: Close
[0m00:39:28.361043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:28.361968 [info ] [MainThread]: 
[0m00:39:28.365099 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:39:28.366641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8747d87-e33c-4284-a2ca-6e150398309b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac38070>]}
[0m00:39:28.367562 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:28.368529 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.369527 [debug] [MainThread]: On master: BEGIN
[0m00:39:28.370772 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:28.371647 [debug] [MainThread]: On master: COMMIT
[0m00:39:28.372518 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.372807 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m00:39:28.373355 [debug] [MainThread]: On master: COMMIT
[0m00:39:28.374095 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt_dev.customers ................................. [RUN]
[0m00:39:28.374677 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:28.375490 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m00:39:28.375754 [debug] [MainThread]: On master: Close
[0m00:39:28.376360 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m00:39:28.377232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:28.377560 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m00:39:28.378279 [info ] [MainThread]: 
[0m00:39:28.380846 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m00:39:28.386494 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:28.387499 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m00:39:28.389284 [debug] [Thread-1  ]: Began running node model.jaffle_shop.orders
[0m00:39:28.390154 [info ] [Thread-1  ]: 1 of 1 START sql table model public.orders ..................................... [RUN]
[0m00:39:28.391096 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.orders"
[0m00:39:28.392053 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.orders
[0m00:39:28.392806 [debug] [Thread-1  ]: Compiling model.jaffle_shop.orders
[0m00:39:28.396487 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m00:39:28.402781 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:28.403529 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.orders
[0m00:39:28.409321 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m00:39:28.412385 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m00:39:28.413136 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m00:39:28.413911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:28.418889 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:28.419856 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m00:39:28.420614 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

  create  table "postgres"."dbt_dev"."customers__dbt_tmp"
  as (
    with
  customers as (

    select *
    from "postgres"."public"."stg_customers"

  ),

  orders as (

    select *
    from "postgres"."public"."stg_orders"

  ),

  payments as (

    select *
    from "postgres"."public"."stg_payments"

  ),

  customer_orders as (

    select
      customer_id,
      min(order_date) as first_order,
      max(order_date) as most_recent_order,
      count(order_id) as number_of_orders
    from orders

    group by customer_id

  ),

  customer_payments as (

    select
      orders.customer_id,
      sum(amount) as total_amount

    from payments

    left join orders on payments.order_id = orders.order_id

    group by orders.customer_id

  ),

  final as (

    select
      customers.customer_id,
      customers.first_name,
      customers.last_name,
      customer_orders.first_order,
      customer_orders.most_recent_order,
      customer_orders.number_of_orders,
      customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders on customers.customer_id = customer_orders.customer_id

    left join customer_payments on customers.customer_id = customer_payments.customer_id

  )

select
  *
from final
  );
  
[0m00:39:28.425852 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m00:39:28.426842 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m00:39:28.430222 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:39:28.430285 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m00:39:28.430893 [debug] [Thread-1  ]: On model.jaffle_shop.orders: BEGIN
[0m00:39:28.431502 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "postgres"."dbt_dev"."customers__dbt_tmp" rename to "customers"
[0m00:39:28.431776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:28.432676 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:39:28.437145 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:28.438002 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:39:28.438639 [debug] [Thread-1  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

  
    

  create  table "postgres"."public"."orders__dbt_tmp"
  as (
    

with orders as (

    select * from "postgres"."public"."stg_orders"

),

payments as (

    select * from "postgres"."public"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
  
[0m00:39:28.443689 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.0 seconds
[0m00:39:28.443812 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m00:39:28.445012 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m00:39:28.445782 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m00:39:28.446959 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:39:28.448027 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:39:28.448777 [debug] [Thread-1  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "postgres"."public"."orders__dbt_tmp" rename to "orders"
[0m00:39:28.449722 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:39:28.450369 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m00:39:28.451091 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "postgres"."dbt_dev"."customers__dbt_backup" cascade
[0m00:39:28.451877 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m00:39:28.453020 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:28.453688 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m00:39:28.454610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f654a595-2fd6-46cb-9a0a-d3222e2d3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fa7f70>]}
[0m00:39:28.455638 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbt_dev.customers ............................ [[32mSELECT 100[0m in 0.08s]
[0m00:39:28.456736 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m00:39:28.458200 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:28.459021 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.459629 [debug] [MainThread]: On master: BEGIN
[0m00:39:28.460376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:28.461266 [debug] [Thread-1  ]: On model.jaffle_shop.orders: COMMIT
[0m00:39:28.462031 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:39:28.462763 [debug] [Thread-1  ]: On model.jaffle_shop.orders: COMMIT
[0m00:39:28.464090 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:39:28.465591 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:28.466535 [debug] [MainThread]: On master: COMMIT
[0m00:39:28.467278 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.467814 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.orders"
[0m00:39:28.468033 [debug] [MainThread]: On master: COMMIT
[0m00:39:28.468773 [debug] [Thread-1  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
drop table if exists "postgres"."public"."orders__dbt_backup" cascade
[0m00:39:28.469685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:28.470819 [debug] [MainThread]: On master: Close
[0m00:39:28.470639 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m00:39:28.471830 [info ] [MainThread]: 
[0m00:39:28.472684 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m00:39:28.472565 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:28.473829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:28.474484 [debug] [Thread-1  ]: On model.jaffle_shop.orders: Close
[0m00:39:28.475057 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m00:39:28.476112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8747d87-e33c-4284-a2ca-6e150398309b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99dff880>]}
[0m00:39:28.477260 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.orders ................................ [[32mSELECT 99[0m in 0.09s]
[0m00:39:28.478484 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.orders
[0m00:39:28.480073 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:28.481009 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.481805 [debug] [MainThread]: On master: BEGIN
[0m00:39:28.482504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:28.487667 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:28.488636 [debug] [MainThread]: On master: COMMIT
[0m00:39:28.489574 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:28.490208 [info ] [MainThread]: 
[0m00:39:28.490542 [debug] [MainThread]: On master: COMMIT
[0m00:39:28.491280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:28.492062 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:28.492666 [info ] [MainThread]: 
[0m00:39:28.493193 [debug] [MainThread]: On master: Close
[0m00:39:28.493925 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:39:28.494873 [info ] [MainThread]: 
[0m00:39:28.495355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b0eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94418a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94418940>]}
[0m00:39:28.496028 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m00:39:28.497003 [debug] [MainThread]: Flushing usage events
[0m00:39:28.497578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:28.498529 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m00:39:28.507953 [info ] [MainThread]: 
[0m00:39:28.508712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:28.509368 [info ] [MainThread]: 
[0m00:39:28.509988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:39:28.511884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac0f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9acb72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a114490>]}
[0m00:39:28.512835 [debug] [MainThread]: Flushing usage events


============================== 2023-01-04 00:39:30.055581 | 8d7fb70c-c807-4def-b948-b38583a99b7c ==============================
[0m00:39:30.055601 [info ] [MainThread]: Running with dbt=1.3.1


============================== 2023-01-04 00:39:30.055663 | d08319d8-da9c-4ac3-8bbe-d58cb20c0f32 ==============================
[0m00:39:30.055686 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:39:30.057917 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['orders'], 'which': 'test', 'rpc_method': 'test'}
[0m00:39:30.056544 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/dbt/jaffle_shop', 'profile': 'postgres_profile', 'indirect_selection': 'eager', 'select': ['customers'], 'which': 'test', 'rpc_method': 'test'}
[0m00:39:30.058941 [debug] [MainThread]: Tracking: tracking
[0m00:39:30.059355 [debug] [MainThread]: Tracking: tracking
[0m00:39:30.064308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a2e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a2e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a2e820>]}
[0m00:39:30.064787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdb48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdb47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdb4820>]}
[0m00:39:30.107515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:30.108556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:30.108499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:30.110956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:30.113754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd08319d8-da9c-4ac3-8bbe-d58cb20c0f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb580a0d0>]}
[0m00:39:30.115794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d7fb70c-c807-4def-b948-b38583a99b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb900d0>]}
[0m00:39:30.153257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd08319d8-da9c-4ac3-8bbe-d58cb20c0f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb717f2b0>]}
[0m00:39:30.154915 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:30.155765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd08319d8-da9c-4ac3-8bbe-d58cb20c0f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb79f8c10>]}
[0m00:39:30.157558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d7fb70c-c807-4def-b948-b38583a99b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5042b0>]}
[0m00:39:30.157835 [info ] [MainThread]: 
[0m00:39:30.158417 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:39:30.159299 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:30.159761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7fb70c-c807-4def-b948-b38583a99b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed7dc10>]}
[0m00:39:30.160931 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:30.161752 [info ] [MainThread]: 
[0m00:39:30.162909 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:30.164421 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbt_dev"
[0m00:39:30.167522 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:30.168354 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:30.169094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:30.171145 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:30.172109 [debug] [ThreadPool]: On list_postgres_dbt_dev: BEGIN
[0m00:39:30.172872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:30.174566 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.175488 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:30.176373 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:30.177998 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.178880 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt_dev"
[0m00:39:30.179372 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.179749 [debug] [ThreadPool]: On list_postgres_dbt_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_dbt_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
[0m00:39:30.181282 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:30.182208 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:30.183125 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.183357 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:30.184765 [debug] [ThreadPool]: On list_postgres_dbt_dev: ROLLBACK
[0m00:39:30.185723 [debug] [ThreadPool]: On list_postgres_dbt_dev: Close
[0m00:39:30.185766 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:30.187032 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:39:30.187237 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:30.188441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:30.189097 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:30.190004 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:39:30.190677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:30.193208 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.194116 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:30.194962 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:30.195479 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.196963 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:39:30.197588 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:39:30.198174 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m00:39:30.199927 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:30.200550 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m00:39:30.200887 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:30.202778 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:39:30.203846 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:39:30.206047 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.207129 [debug] [MainThread]: On master: BEGIN
[0m00:39:30.207992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:30.208585 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.209632 [debug] [MainThread]: On master: BEGIN
[0m00:39:30.210488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:30.213035 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.213918 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.214703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:30.215655 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.216604 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.217478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:39:30.220732 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:39:30.222268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd08319d8-da9c-4ac3-8bbe-d58cb20c0f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb659a4f0>]}
[0m00:39:30.223216 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:30.223436 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:39:30.224209 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.225516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7fb70c-c807-4def-b948-b38583a99b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d9122b0>]}
[0m00:39:30.225531 [debug] [MainThread]: On master: BEGIN
[0m00:39:30.226471 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:30.227120 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.227635 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.228088 [debug] [MainThread]: On master: COMMIT
[0m00:39:30.228948 [debug] [MainThread]: On master: BEGIN
[0m00:39:30.229554 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.230376 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.230708 [debug] [MainThread]: On master: COMMIT
[0m00:39:30.231268 [debug] [MainThread]: On master: COMMIT
[0m00:39:30.232368 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.231956 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:30.233001 [debug] [MainThread]: On master: COMMIT
[0m00:39:30.233305 [debug] [MainThread]: On master: Close
[0m00:39:30.234020 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:30.234809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:30.236038 [debug] [MainThread]: On master: Close
[0m00:39:30.236629 [info ] [MainThread]: 
[0m00:39:30.237357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:30.239269 [info ] [MainThread]: 
[0m00:39:30.247685 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:39:30.248652 [info ] [Thread-1  ]: 1 of 10 START test accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m00:39:30.249089 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m00:39:30.249932 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:39:30.250242 [info ] [Thread-1  ]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m00:39:30.251157 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:39:30.252104 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m00:39:30.252404 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:39:30.253030 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m00:39:30.254165 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m00:39:30.261442 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m00:39:30.261655 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:39:30.269576 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.270607 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m00:39:30.271086 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.272172 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:39:30.279443 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m00:39:30.280938 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:39:30.287106 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m00:39:30.288085 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: BEGIN
[0m00:39:30.288972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.289042 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:39:30.290653 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: BEGIN
[0m00:39:30.291418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.293921 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.294712 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m00:39:30.295421 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."dbt_dev"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:39:30.295808 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.296855 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m00:39:30.297319 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.297529 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."public"."orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m00:39:30.299130 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.300015 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
[0m00:39:30.300047 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.300885 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m00:39:30.302353 [info ] [Thread-1  ]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.05s]
[0m00:39:30.302528 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.303606 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m00:39:30.304606 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: ROLLBACK
[0m00:39:30.305518 [debug] [Thread-1  ]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.306341 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: Close
[0m00:39:30.307036 [info ] [Thread-1  ]: 2 of 3 START test relationships_orders_customer_id__customer_id__ref_customers_  [RUN]
[0m00:39:30.308079 [info ] [Thread-1  ]: 1 of 10 PASS accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.06s]
[0m00:39:30.308725 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.309532 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m00:39:30.310231 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.310946 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:39:30.311743 [debug] [Thread-1  ]: Compiling test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.312403 [info ] [Thread-1  ]: 2 of 10 START test not_null_orders_amount ...................................... [RUN]
[0m00:39:30.313991 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:39:30.314861 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:39:30.315753 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:39:30.317693 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.320424 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:39:30.321441 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.322294 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.323321 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.324096 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:39:30.324284 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.325832 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:39:30.327967 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.328268 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:39:30.328733 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: BEGIN
[0m00:39:30.329236 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: BEGIN
[0m00:39:30.329747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.330270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.335153 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.335173 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.335957 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m00:39:30.336643 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.337243 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_amount.106140f9fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "postgres"."public"."orders"
where amount is null



      
    ) dbt_internal_test
[0m00:39:30.337794 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "postgres"."public"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "postgres"."dbt_dev"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:39:30.339358 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.340174 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.340747 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.341519 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: ROLLBACK
[0m00:39:30.341538 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.342358 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: Close
[0m00:39:30.342921 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: ROLLBACK
[0m00:39:30.343766 [info ] [Thread-1  ]: 2 of 10 PASS not_null_orders_amount ............................................ [[32mPASS[0m in 0.03s]
[0m00:39:30.344267 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
[0m00:39:30.344986 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m00:39:30.345828 [info ] [Thread-1  ]: 2 of 3 PASS relationships_orders_customer_id__customer_id__ref_customers_ ...... [[32mPASS[0m in 0.04s]
[0m00:39:30.346332 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:39:30.347317 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.347948 [info ] [Thread-1  ]: 3 of 10 START test not_null_orders_bank_transfer_amount ........................ [RUN]
[0m00:39:30.348785 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m00:39:30.349828 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:39:30.351148 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:39:30.350250 [info ] [Thread-1  ]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m00:39:30.352461 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m00:39:30.351858 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:39:30.352852 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m00:39:30.353870 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m00:39:30.355769 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:39:30.358001 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m00:39:30.358899 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.359705 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:39:30.360589 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.361357 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m00:39:30.361528 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:39:30.363517 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m00:39:30.364490 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:39:30.365199 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: BEGIN
[0m00:39:30.365731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.369236 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m00:39:30.369928 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: BEGIN
[0m00:39:30.370604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.370817 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.373002 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m00:39:30.373817 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select bank_transfer_amount
from "postgres"."public"."orders"
where bank_transfer_amount is null



      
    ) dbt_internal_test
[0m00:39:30.375531 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.375688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.376904 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m00:39:30.377563 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_dev"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:39:30.377051 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.378460 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: ROLLBACK
[0m00:39:30.379167 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: Close
[0m00:39:30.379357 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.380090 [info ] [Thread-1  ]: 3 of 10 PASS not_null_orders_bank_transfer_amount .............................. [[32mPASS[0m in 0.03s]
[0m00:39:30.381746 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.381969 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m00:39:30.382593 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
[0m00:39:30.383289 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:39:30.384010 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m00:39:30.384459 [info ] [Thread-1  ]: 4 of 10 START test not_null_orders_coupon_amount ............................... [RUN]
[0m00:39:30.385967 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:39:30.385451 [info ] [Thread-1  ]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 0.03s]
[0m00:39:30.386375 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:39:30.386888 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m00:39:30.387513 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:39:30.389025 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:30.389737 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.390412 [debug] [MainThread]: On master: BEGIN
[0m00:39:30.391394 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:39:30.391368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:30.394398 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.395133 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:39:30.396984 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:39:30.397176 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.398504 [debug] [MainThread]: On master: COMMIT
[0m00:39:30.399170 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.399805 [debug] [MainThread]: On master: COMMIT
[0m00:39:30.400473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:30.401069 [debug] [MainThread]: On master: Close
[0m00:39:30.402051 [info ] [MainThread]: 
[0m00:39:30.402404 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:39:30.403108 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m00:39:30.403701 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: BEGIN
[0m00:39:30.404393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:30.405472 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m00:39:30.404915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.410254 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m00:39:30.411018 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m00:39:30.411825 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select coupon_amount
from "postgres"."public"."orders"
where coupon_amount is null



      
    ) dbt_internal_test
[0m00:39:30.415390 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.416799 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.417442 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: ROLLBACK
[0m00:39:30.418270 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: Close
[0m00:39:30.418590 [info ] [MainThread]: 
[0m00:39:30.419188 [info ] [Thread-1  ]: 4 of 10 PASS not_null_orders_coupon_amount ..................................... [[32mPASS[0m in 0.03s]
[0m00:39:30.419654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:30.420249 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m00:39:30.421460 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:39:30.420906 [info ] [MainThread]: 
[0m00:39:30.422394 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:39:30.422044 [info ] [Thread-1  ]: 5 of 10 START test not_null_orders_credit_card_amount .......................... [RUN]
[0m00:39:30.423068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb3af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb3aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb3a040>]}
[0m00:39:30.423732 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:39:30.424038 [debug] [MainThread]: Flushing usage events
[0m00:39:30.424724 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:39:30.425793 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:39:30.428836 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:39:30.436396 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.437092 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:39:30.439509 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:39:30.442438 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:39:30.443205 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: BEGIN
[0m00:39:30.443858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.448490 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.449284 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m00:39:30.449847 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_card_amount
from "postgres"."public"."orders"
where credit_card_amount is null



      
    ) dbt_internal_test
[0m00:39:30.451264 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.452545 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.453205 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: ROLLBACK
[0m00:39:30.454002 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: Close
[0m00:39:30.454863 [info ] [Thread-1  ]: 5 of 10 PASS not_null_orders_credit_card_amount ................................ [[32mPASS[0m in 0.03s]
[0m00:39:30.455708 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m00:39:30.456424 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:39:30.457125 [info ] [Thread-1  ]: 6 of 10 START test not_null_orders_customer_id ................................. [RUN]
[0m00:39:30.458144 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:39:30.459021 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:39:30.459897 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:39:30.462907 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:39:30.467470 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.468210 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:39:30.469816 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:39:30.472202 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:39:30.472887 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: BEGIN
[0m00:39:30.473438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.477853 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.478540 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m00:39:30.479322 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."orders"
where customer_id is null



      
    ) dbt_internal_test
[0m00:39:30.480806 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.482045 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.482666 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: ROLLBACK
[0m00:39:30.483355 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: Close
[0m00:39:30.484208 [info ] [Thread-1  ]: 6 of 10 PASS not_null_orders_customer_id ....................................... [[32mPASS[0m in 0.03s]
[0m00:39:30.485188 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m00:39:30.486061 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:39:30.486852 [info ] [Thread-1  ]: 7 of 10 START test not_null_orders_gift_card_amount ............................ [RUN]
[0m00:39:30.487794 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:39:30.488606 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:39:30.489441 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:39:30.492455 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:39:30.495285 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.495985 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:39:30.497716 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:39:30.502793 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:39:30.503500 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: BEGIN
[0m00:39:30.504064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.508555 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.509370 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m00:39:30.510147 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gift_card_amount
from "postgres"."public"."orders"
where gift_card_amount is null



      
    ) dbt_internal_test
[0m00:39:30.511905 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.513611 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.514420 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: ROLLBACK
[0m00:39:30.515365 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: Close
[0m00:39:30.516529 [info ] [Thread-1  ]: 7 of 10 PASS not_null_orders_gift_card_amount .................................. [[32mPASS[0m in 0.03s]
[0m00:39:30.517752 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m00:39:30.518757 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:39:30.520059 [info ] [Thread-1  ]: 8 of 10 START test not_null_orders_order_id .................................... [RUN]
[0m00:39:30.521221 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:39:30.522030 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:39:30.522981 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:39:30.526453 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:39:30.530066 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.531028 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:39:30.532910 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:39:30.536027 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:39:30.536599 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: BEGIN
[0m00:39:30.537164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.541907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.542893 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m00:39:30.543665 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m00:39:30.545534 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.547058 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.547848 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: ROLLBACK
[0m00:39:30.548583 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: Close
[0m00:39:30.549589 [info ] [Thread-1  ]: 8 of 10 PASS not_null_orders_order_id .......................................... [[32mPASS[0m in 0.03s]
[0m00:39:30.550785 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m00:39:30.551639 [debug] [Thread-1  ]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.552548 [info ] [Thread-1  ]: 9 of 10 START test relationships_orders_customer_id__customer_id__ref_customers_  [RUN]
[0m00:39:30.553666 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.554534 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.555416 [debug] [Thread-1  ]: Compiling test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.561244 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.565100 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.585612 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.587898 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.590323 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.591231 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: BEGIN
[0m00:39:30.591820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.596384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.597279 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:39:30.598019 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "postgres"."public"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "postgres"."dbt_dev"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:39:30.600038 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.601643 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.602749 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: ROLLBACK
[0m00:39:30.603741 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
[0m00:39:30.604835 [info ] [Thread-1  ]: 9 of 10 PASS relationships_orders_customer_id__customer_id__ref_customers_ ..... [[32mPASS[0m in 0.05s]
[0m00:39:30.605778 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:39:30.606667 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:39:30.607469 [info ] [Thread-1  ]: 10 of 10 START test unique_orders_order_id ..................................... [RUN]
[0m00:39:30.608488 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:39:30.609262 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:39:30.610023 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:39:30.615417 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:39:30.620353 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.621257 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:39:30.623203 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:39:30.626007 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:39:30.626733 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: BEGIN
[0m00:39:30.627363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:30.631909 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.632798 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m00:39:30.634361 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:39:30.636608 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m00:39:30.637991 [debug] [Thread-1  ]: finished collecting timing info
[0m00:39:30.638678 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: ROLLBACK
[0m00:39:30.639382 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: Close
[0m00:39:30.640292 [info ] [Thread-1  ]: 10 of 10 PASS unique_orders_order_id ........................................... [[32mPASS[0m in 0.03s]
[0m00:39:30.641287 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m00:39:30.642934 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:39:30.643894 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.644711 [debug] [MainThread]: On master: BEGIN
[0m00:39:30.645530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:30.650205 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:39:30.651143 [debug] [MainThread]: On master: COMMIT
[0m00:39:30.651987 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:30.652755 [debug] [MainThread]: On master: COMMIT
[0m00:39:30.653666 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:39:30.654423 [debug] [MainThread]: On master: Close
[0m00:39:30.655564 [info ] [MainThread]: 
[0m00:39:30.656522 [info ] [MainThread]: Finished running 10 tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m00:39:30.657527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:30.658315 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e' was properly closed.
[0m00:39:30.669964 [info ] [MainThread]: 
[0m00:39:30.670690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:30.671322 [info ] [MainThread]: 
[0m00:39:30.671975 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:39:30.672682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57a6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57a6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f2ea30>]}
[0m00:39:30.673295 [debug] [MainThread]: Flushing usage events
